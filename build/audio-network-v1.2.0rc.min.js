/*
The MIT License (MIT)

Copyright (c) 2015-2017 Robert Rypu≈Ça - https://audio-network.rypula.pl

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

"use strict";var AudioNetwork={},AudioNetworkBootConfig=AudioNetworkBootConfig||{};AudioNetwork.version="1.2.0rc",AudioNetwork.isNode=!("undefined"==typeof module||!module.exports),AudioNetwork.isWebWorker=!AudioNetwork.isNode&&"undefined"!=typeof WorkerGlobalScope&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,AudioNetwork.isBrowser=!AudioNetwork.isNode&&!AudioNetwork.isWebWorker&&"undefined"!=typeof navigator&&"undefined"!=typeof document,AudioNetwork.MULTICORE_STATE={DISABLED:"DISABLED",ENABLED_USE_PROD_SCRIPT:"ENABLED_USE_PROD_SCRIPT",ENABLED_USE_DEV_SCRIPT:"ENABLED_USE_DEV_SCRIPT"},AudioNetwork.bootConfig={devScriptBaseUrl:"string"==typeof AudioNetworkBootConfig.devScriptBaseUrl?AudioNetworkBootConfig.devScriptBaseUrl:AudioNetwork.isBrowser?window.location.origin+"/src/":"",prodScriptBaseUrl:"string"==typeof AudioNetworkBootConfig.prodScriptBaseUrl?AudioNetworkBootConfig.prodScriptBaseUrl:AudioNetwork.isBrowser?window.location.origin+"/build/":"",prodScriptName:"string"==typeof AudioNetworkBootConfig.prodScriptName?AudioNetworkBootConfig.prodScriptName:"audio-network-v"+AudioNetwork.version+".min.js",devScriptLoad:"undefined"!=typeof AudioNetworkBootConfig.devScriptLoad&&!!AudioNetworkBootConfig.devScriptLoad,createAlias:"undefined"==typeof AudioNetworkBootConfig.createAlias||!!AudioNetworkBootConfig.createAlias,multicoreState:Object.keys(AudioNetwork.MULTICORE_STATE).indexOf(AudioNetworkBootConfig.multicoreState)!==-1?AudioNetworkBootConfig.multicoreState:AudioNetwork.MULTICORE_STATE.DISABLED},AudioNetwork.Injector=function(){var e;return e=function(){this.$$injectRepository={}},e.RESOLVE_RECURSION_LIMIT=20,e.RESOLVE_RECURSION_LIMIT_EXCEED_EXCEPTION="Injector - resolve recursion limit exceed",e.MULTIPLE_REGISTER_EXCEPTION="Injector - multiple register calls for the same name",e.UNABLE_TO_FIND_ITEM_EXCEPTION="Injector - unable to find factory/service for given name: ",e.TYPE={SERVICE:"SERVICE",FACTORY:"FACTORY"},e.$$resolveRecursionCounter=0,e.prototype.$$register=function(t,i,r){if("undefined"!=typeof this.$$injectRepository[t])throw e.MULTIPLE_REGISTER_EXCEPTION;this.$$injectRepository[t]={type:r,item:i,resolveCache:null}},e.prototype.registerService=function(t,i){this.$$register(t,i,e.TYPE.SERVICE)},e.prototype.registerFactory=function(t,i){this.$$register(t,i,e.TYPE.FACTORY)},e.prototype.resolve=function(t){var i,r,n=[];if(r=this.$$find(t),r.resolveCache)return r.resolveCache;for(this.$$resolveRecursionInc(),i=0;i<r.item.$inject.length;i++)n.push(this.resolve(r.item.$inject[i]));switch(r.type){case e.TYPE.SERVICE:r.resolveCache=this.$$injectDependenciesAndInstantiate(r,n);break;case e.TYPE.FACTORY:r.resolveCache=this.$$injectDependencies(r,n)}return this.$$resolveRecursionDec(),r.resolveCache},e.prototype.$$resolveRecursionInc=function(){if(e.$$resolveRecursionCounter++,e.$$resolveRecursionCounter>=e.RESOLVE_RECURSION_LIMIT)throw e.RESOLVE_RECURSION_LIMIT_EXCEED_EXCEPTION},e.prototype.$$resolveRecursionDec=function(){e.$$resolveRecursionCounter--},e.prototype.$$injectDependenciesAndInstantiate=function(e,t){var i,r=e,n=t;switch(t.length){case 0:i=new r.item;break;case 1:i=new r.item(n[0]);break;case 2:i=new r.item(n[0],n[1]);break;case 3:i=new r.item(n[0],n[1],n[2]);break;case 4:i=new r.item(n[0],n[1],n[2],n[3]);break;case 5:i=new r.item(n[0],n[1],n[2],n[3],n[4]);break;case 6:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5]);break;case 7:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6]);break;case 8:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);break;case 9:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8]);break;case 10:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]);break;case 11:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10]);break;case 12:i=new r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11])}return i},e.prototype.$$injectDependencies=function(e,t){var i,r=e,n=t;switch(t.length){case 0:i=r.item();break;case 1:i=r.item(n[0]);break;case 2:i=r.item(n[0],n[1]);break;case 3:i=r.item(n[0],n[1],n[2]);break;case 4:i=r.item(n[0],n[1],n[2],n[3]);break;case 5:i=r.item(n[0],n[1],n[2],n[3],n[4]);break;case 6:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5]);break;case 7:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6]);break;case 8:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]);break;case 9:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8]);break;case 10:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]);break;case 11:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10]);break;case 12:i=r.item(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11])}return i},e.prototype.$$find=function(t){var i;for(i in this.$$injectRepository)if(this.$$injectRepository.hasOwnProperty(i)&&i===t)return this.$$injectRepository[i];throw e.UNABLE_TO_FIND_ITEM_EXCEPTION+t},new e}(),AudioNetwork.DynamicScriptLoader=function(){var e;return e=function(){},e.prototype.loadList=function(e,t){var i;for("undefined"==typeof t&&(t=0),i=t;i<e.length;i++)this.loadOne(e[i])},e.prototype.loadOne=function(e){document.write('<script src="'+AudioNetwork.bootConfig.devScriptBaseUrl+e+'"></script>')},new e}(),AudioNetwork.devScriptList=["audio-network-boot.js","-deprecated-probably/common/math-util/math-util.service.js","-deprecated-probably/common/simple-promise/simple-promise-builder.service.js","-deprecated-probably/common/simple-promise/simple-promise.factory.js","-deprecated-probably/common/stopwatch/stopwatch-builder.service.js","-deprecated-probably/common/stopwatch/stopwatch.factory.js","-deprecated-probably/common/window-function/window-function.service.js","-deprecated-probably/physical-layer-core/receive-multicore-worker/receive-multicore-worker-thread.service.js","-deprecated-probably/physical-layer-core/receive-multicore-worker/receive-multicore-worker.factory.js","-deprecated-probably/physical-layer-core/receive-worker/receive-worker.factory.js","-deprecated/audio/active-audio-context/active-audio-context.service.js","-deprecated/audio/simple-audio-context/simple-audio-context-builder.service.js","-deprecated/audio/simple-audio-context/simple-audio-context.factory.js","-deprecated/common/abstract-value-collector/abstract-value-collector.factory.js","-deprecated/common/average-value-collector/average-value-collector-builder.service.js","-deprecated/common/average-value-collector/average-value-collector.factory.js","-deprecated/common/carrier-generate/carrier-generate-builder.service.js","-deprecated/common/carrier-generate/carrier-generate.factory.js","-deprecated/common/carrier-recovery/carrier-recovery-builder.service.js","-deprecated/common/carrier-recovery/carrier-recovery.factory.js","-deprecated/common/complex/complex-builder.service.js","-deprecated/common/complex/complex.factory.js","-deprecated/common/queue/queue-builder.service.js","-deprecated/common/queue/queue.factory.js","-deprecated/common/util/util.service.js","-deprecated/physical-layer-adapter/guard-power-collector/guard-power-collector-builder.service.js","-deprecated/physical-layer-adapter/guard-power-collector/guard-power-collector.factory.js","-deprecated/physical-layer-adapter/phase-offset-collector/phase-offset-collector-builder.service.js","-deprecated/physical-layer-adapter/phase-offset-collector/phase-offset-collector.factory.js","-deprecated/physical-layer-adapter/receive-adapter-state.service.js","-deprecated/physical-layer-adapter/receive-adapter.factory.js","-deprecated/physical-layer-adapter/rx-state-machine-manager/rx-state-machine-manager-builder.service.js","-deprecated/physical-layer-adapter/rx-state-machine-manager/rx-state-machine-manager.factory.js","-deprecated/physical-layer-adapter/rx-state-machine/rx-state-machine-builder.service.js","-deprecated/physical-layer-adapter/rx-state-machine/rx-state-machine.factory.js","-deprecated/physical-layer-adapter/signal-power-collector/signal-power-collector-builder.service.js","-deprecated/physical-layer-adapter/signal-power-collector/signal-power-collector.factory.js","-deprecated/physical-layer-adapter/transmit-adapter.factory.js","-deprecated/physical-layer/abstract-channel-manager/abstract-channel-manager.factory.js","-deprecated/physical-layer/channel-receive-manager/channel-receive-manager-builder.service.js","-deprecated/physical-layer/channel-receive-manager/channel-receive-manager.factory.js","-deprecated/physical-layer/channel-receive/channel-receive-builder.service.js","-deprecated/physical-layer/channel-receive/channel-receive.factory.js","-deprecated/physical-layer/channel-transmit-manager/channel-transmit-manager-builder.service.js","-deprecated/physical-layer/channel-transmit-manager/channel-transmit-manager.factory.js","-deprecated/physical-layer/channel-transmit/channel-transmit-builder.service.js","-deprecated/physical-layer/channel-transmit/channel-transmit.factory.js","-deprecated/physical-layer/configuration-parser.service.js","-deprecated/physical-layer/default-config.service.js","-deprecated/physical-layer/physical-layer.factory.js","-deprecated/physical-layer/rx-handler/rx-handler-builder.service.js","-deprecated/physical-layer/rx-handler/rx-handler.factory.js","-deprecated/physical-layer/rx-input.service.js","dsp/complex.js","dsp/correlator.js","dsp/fft-result.js","dsp/wave-analyser.js","dsp/wave-generator.js","physical-layer/physical-layer-builder.js","physical-layer/physical-layer.js","physical-layer/rx-sync-detector.js","physical-layer/tx-symbol-manager.js","physical-layer/tx-symbol.js","util/buffer.js","util/frequency-calculator.js","util/music-calculator.js","util/smart-timer.js","util/wav-audio-file.js","visualizer/abstract-2d-visualizer/abstract-2d-visualizer.factory.js","visualizer/abstract-visualizer/abstract-visualizer.factory.js","visualizer/analyser-chart/analyser-chart-builder.service.js","visualizer/analyser-chart/analyser-chart-template-axis-x.service.js","visualizer/analyser-chart/analyser-chart-template-main.service.js","visualizer/analyser-chart/analyser-chart.factory.js","visualizer/complex-plane-chart/complex-plane-chart-builder.service.js","visualizer/complex-plane-chart/complex-plane-chart-template-main.service.js","visualizer/complex-plane-chart/complex-plane-chart.factory.js","visualizer/constellation-diagram/constellation-diagram-builder.service.js","visualizer/constellation-diagram/constellation-diagram-template-main.service.js","visualizer/constellation-diagram/constellation-diagram.factory.js","visualizer/frequency-domain-chart/frequency-domain-chart-builder.service.js","visualizer/frequency-domain-chart/frequency-domain-chart-template-main.service.js","visualizer/frequency-domain-chart/frequency-domain-chart.factory.js","visualizer/power-chart/power-chart-builder.service.js","visualizer/power-chart/power-chart-template-main.service.js","visualizer/power-chart/power-chart.factory.js","visualizer/sample-chart/sample-chart-builder.service.js","visualizer/sample-chart/sample-chart-template-main.service.js","visualizer/sample-chart/sample-chart.factory.js","web-audio/audio-mono-io-lite.js","web-audio/audio-mono-io.js","audio-network-end.js"],AudioNetwork.isBrowser&&AudioNetwork.bootConfig.devScriptLoad&&AudioNetwork.DynamicScriptLoader.loadList(AudioNetwork.devScriptList,1),function(){function e(){var e;return e=function(e,t){this.$$real=e,this.$$imag=t},e.$$_EPSILON=1e-6,e.$$_UNIT_RADIUS=1,e.prototype.clone=function(){return new e(this.$$real,this.$$imag)},e.polar=function(t,i){var r;return i="undefined"==typeof i?e.$$_UNIT_RADIUS:i,r=2*Math.PI*t,new e(i*Math.cos(r),i*Math.sin(r))},e.zero=function(){return new e(0,0)},e.prototype.add=function(e){this.$$real+=e.$$real,this.$$imag+=e.$$imag},e.prototype.subtract=function(e){this.$$real-=e.$$real,this.$$imag-=e.$$imag},e.prototype.multiply=function(e){var t=this.$$real*e.$$real-this.$$imag*e.$$imag,i=this.$$real*e.$$imag+this.$$imag*e.$$real;this.$$real=t,this.$$imag=i},e.prototype.conjugate=function(){this.$$imag*=-1},e.prototype.multiplyScalar=function(e){this.$$real*=e,this.$$imag*=e},e.prototype.divideScalar=function(e){this.$$real/=e,this.$$imag/=e},e.prototype.getReal=function(){return this.$$real},e.prototype.getImaginary=function(){return this.$$imag},e.prototype.getMagnitude=function(){return Math.sqrt(this.$$real*this.$$real+this.$$imag*this.$$imag)},e.prototype.getUnitAngle=function(){var t,i,r,n,o,a;switch(t=this.$$real,i=this.$$imag,r=this.getMagnitude(),r=r<e.$$_EPSILON?e.$$_EPSILON:r,n=i>=0?t>=0?1:2:t<=0?3:4){case 1:o=Math.asin(i/r);break;case 2:o=Math.asin(-t/r)+.5*Math.PI;break;case 3:o=Math.asin(-i/r)+Math.PI;break;case 4:o=Math.asin(t/r)+1.5*Math.PI}return a=o/(2*Math.PI)},e.prototype.normalize=function(){this.divideScalar(this.getMagnitude())},e}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.Complex",e),e.$inject=[]}(),function(){function e(e){var t;return t=function(e,i){this.$$correlationCode=i?i.slice(0):t.DEFAULT_CORRELATION_CODE.slice(0),this.$$skipFactor=void 0,this.$$dataBuffer=void 0,this.$$signalDecibelBuffer=void 0,this.$$noiseDecibelBuffer=void 0,this.$$cacheCorrelactionValue=void 0,this.$$cacheSignalDecibelAverage=void 0,this.$$cacheNoiseDecibelAverage=void 0,this.$$setSkipFactor(e)},t.DEFAULT_CORRELATION_CODE=[1,1,1,-1,-1,-1,1,-1,-1,1,-1],t.CORRELATION_POSITIVE="CORRELATION_POSITIVE",t.CORRELATION_NONE="CORRELATION_NONE",t.CORRELATION_NEGATIVE="CORRELATION_NEGATIVE",t.THRESHOLD_UNIT=.9,t.NO_DECIBEL=null,t.NO_DATA=0,t.POSITION_OUT_OF_RANGE_EXCEPTION="Position out of range",t.prototype.reset=function(){this.$$setSkipFactor(this.$$skipFactor)},t.prototype.handle=function(e,i,r){var n,o;switch(n=t.NO_DATA,e){case-1:case 1:n=e}this.$$dataBuffer.pushEvenIfFull(n),o=n&&(i||0===i),this.$$signalDecibelBuffer.pushEvenIfFull(o?i:t.NO_DECIBEL),o=n&&(r||0===r),this.$$noiseDecibelBuffer.pushEvenIfFull(o?r:t.NO_DECIBEL),this.$$clearCache()},t.prototype.isCorrelated=function(){var e=this.getCorrelation();return e===t.CORRELATION_NEGATIVE||e===t.CORRELATION_POSITIVE},t.prototype.getCorrelation=function(){var e=this.getCorrelationValue(),i=Math.floor(t.THRESHOLD_UNIT*this.$$correlationCode.length);return e>=i?t.CORRELATION_POSITIVE:e>-i?t.CORRELATION_NONE:t.CORRELATION_NEGATIVE},t.prototype.getCorrelationValue=function(){var e,i,r,n,o,a;if(void 0!==this.$$cacheCorrelactionValue)return this.$$cacheCorrelactionValue;for(a=0,i=this.$$skipFactor-1,e=0;e<this.$$correlationCode.length;e++)r=i+e*this.$$skipFactor,n=this.$$dataBuffer.getItem(r),n!==t.NO_DATA&&(o=this.$$correlationCode[e],a+=n*o);return this.$$cacheCorrelactionValue=a,a},t.prototype.getSignalDecibelAverage=function(){return void 0===this.$$cacheSignalDecibelAverage&&(this.$$cacheSignalDecibelAverage=this.$$getDecibelAverage(this.$$signalDecibelBuffer)),this.$$cacheSignalDecibelAverage},t.prototype.getNoiseDecibelAverage=function(){return void 0===this.$$cacheNoiseDecibelAverage&&(this.$$cacheNoiseDecibelAverage=this.$$getDecibelAverage(this.$$noiseDecibelBuffer)),this.$$cacheNoiseDecibelAverage},t.prototype.getSignalToNoiseRatio=function(){var e,i=this.getSignalDecibelAverage(),r=this.getNoiseDecibelAverage(),n=0;return e=i!==t.NO_DECIBEL&&r!==t.NO_DECIBEL,e&&(n=i-r),n},t.prototype.getCorrelationCodeLength=function(){return this.$$correlationCode.length},t.prototype.$$clearCache=function(){this.$$cacheCorrelactionValue=void 0,this.$$cacheSignalDecibelAverage=void 0,this.$$cacheNoiseDecibelAverage=void 0},t.prototype.$$getDecibelAverage=function(e){var i,r,n,o,a,s,$;for(a=0,s=0,r=this.$$skipFactor-1,i=0;i<this.$$correlationCode.length;i++)n=r+i*this.$$skipFactor,o=e.getItem(n),o!==t.NO_DECIBEL&&(a+=o,s++);return $=s>0?a/s:t.NO_DECIBEL},t.prototype.$$setSkipFactor=function(i){var r,n;for(i=i||1,n=this.$$correlationCode.length*i,this.$$skipFactor=i,this.$$dataBuffer=new e(n),this.$$signalDecibelBuffer=new e(n),this.$$noiseDecibelBuffer=new e(n),this.$$cacheCorrelactionValue=void 0,this.$$cacheSignalDecibelAverage=void 0,this.$$cacheNoiseDecibelAverage=void 0,r=0;r<n;r++)this.$$dataBuffer.pushEvenIfFull(t.NO_DATA),this.$$signalDecibelBuffer.pushEvenIfFull(t.NO_DECIBEL),this.$$noiseDecibelBuffer.pushEvenIfFull(t.NO_DECIBEL)},t}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.Correlator",e),e.$inject=["Rewrite.Util.Buffer"]}(),function(){function e(){var e;return e=function(e,t){this.$$fftData=e,this.$$sampleRate=t},e.$$_FREQUENCY_BIN_INDEX_ZERO=0,e.$$_FREQUENCY_BIN_INDEX_FIRST=1,e.$$_EQUAL_EPSILON=.001,e.$$_HALF=.5,e.VALUES_OUT_OF_RANGE="Values out of range",e.prototype.downconvert=function(e){var t,i,r,n,o=[],a=Math.floor(e/2);for(r=0;r<this.$$fftData.length;r+=e){for(i=this.$$fftData[r],n=Math.max(0,r-a);n<Math.min(r-a+e,this.$$fftData.length);n++)i=this.$$fftData[n]>i?this.$$fftData[n]:i;o.push(i)}t=e*o.length/this.$$fftData.length,this.$$sampleRate*=t,this.$$fftData=o},e.prototype.getLoudestBinIndex=function(e,t){return this.$$getLoudestBinIndexInRange(e,t)},e.prototype.getLoudestBinIndexInBinRange=function(t,i){var r=e.$$_HALF*this.getFFTSize();if(t<0||i>=r)throw e.VALUES_OUT_OF_RANGE;return e.$$findMaxIndexInRange(this.$$fftData,t,i)},e.prototype.getLoudestFrequency=function(t,i){var r=this.$$getLoudestBinIndexInRange(t,i);return e.getFrequency(r,this.$$sampleRate,this.getFFTSize())},e.prototype.getLoudestDecibel=function(e,t){var i=this.$$getLoudestBinIndexInRange(e,t);return this.$$fftData[i]},e.prototype.getDecibelAverage=function(t,i,r){var n,o,a,s,$=e.$$_HALF*this.getFFTSize();if(t<0||i>=$)throw e.VALUES_OUT_OF_RANGE;for(n=0,o=0,s=t;s<=i;s++)"undefined"!=typeof r&&s===r||(o+=this.getDecibel(s),n++);return a=0,n>0&&(a=o/n),a},e.prototype.getDecibelRange=function(t,i){var r,n=e.$$_HALF*this.getFFTSize(),o=[];if(t<0||i>=n)throw e.VALUES_OUT_OF_RANGE;for(r=t;r<=i;r++)o.push(this.getDecibel(r));return o},e.prototype.getDecibel=function(e){return this.$$fftData[e]},e.prototype.getDecibelFromFrequency=function(e){var t=this.getBinIndex(e);return this.$$fftData[t]},e.prototype.getFrequencyData=function(){return this.$$fftData},e.prototype.getFrequency=function(t){return e.getFrequency(t,this.$$sampleRate,this.getFFTSize())},e.prototype.getFrequencyOfClosestBin=function(t){return e.getFrequencyOfClosestBin(t,this.$$sampleRate,this.getFFTSize())},e.prototype.getBinIndex=function(t){return e.getBinIndex(t,this.$$sampleRate,this.getFFTSize())},e.prototype.getResolution=function(){return e.getResolution(this.$$sampleRate,this.getFFTSize())},e.prototype.getLastBinIndex=function(){return this.$$fftData.length-1},e.prototype.getLastFrequency=function(){return this.getFrequency(this.getLastBinIndex())},e.prototype.getNyquistFrequency=function(){return e.$$_HALF*this.$$sampleRate},e.prototype.getSampleRate=function(){return this.$$sampleRate},e.prototype.getFFTSize=function(){return 2*this.$$fftData.length},e.prototype.equal=function(t){var i,r,n,o,a;if(n=e.$$isEqual(this.getNyquistFrequency(),t.getNyquistFrequency()),o=e.$$isEqual(this.getFFTSize(),t.getFFTSize()),!n||!o)return!1;for(a=!0,i=0;i<this.$$fftData.length;i++)if(r=Math.abs(this.$$fftData[i]-t.getDecibel(i)),r>e.$$_EQUAL_EPSILON){a=!1;break}return a},e.prototype.$$getLoudestBinIndexInRange=function(t,i){var r,n,o;return t=e.$$getValueOrDefault(t,e.$$_FREQUENCY_BIN_INDEX_ZERO),i=e.$$getValueOrDefault(i,this.getLastFrequency()),r=this.getBinIndex(t),n=this.getBinIndex(i),o=e.$$findMaxIndexInRange(this.$$fftData,r,n)},e.$$isEqual=function(e,t){return e===t},e.$$getValueOrDefault=function(e,t){return"undefined"!=typeof e?e:t},e.$$findMaxIndexInRange=function(e,t,i){var r,n,o;for(r=-1,n=void 0,o=t;o<=i;o++)(r===-1||e[o]>n)&&(n=e[o],r=o);return r},e.getResolution=function(t,i){return e.getFrequency(e.$$_FREQUENCY_BIN_INDEX_FIRST,t,i)},e.getFrequency=function(t,i,r){var n=e.$$_HALF*r;if(t<0||t>=n)throw e.VALUES_OUT_OF_RANGE;return t*i/r},e.getBinIndex=function(t,i,r){var n=Math.round(t*r/i),o=e.$$_HALF*r;if(n<0||n>=o)throw e.VALUES_OUT_OF_RANGE;return n},e.getFrequencyOfClosestBin=function(t,i,r){var n=e.getBinIndex(t,i,r);return e.getFrequency(n,i,r)},e}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.FFTResult",e),e.$inject=[]}(),function(){function e(e,t){var i;return i=function(e,r,n){e=e||i.$$_DEFAULT_SAMPLE_PER_PERIOD,r=r||i.$$_DEFAULT_WINDOW_SIZE,this.$$cyclePerSample=null,this.$$firstSampleOfBufferNumber=null,this.setSamplePerPeriod(e),this.$$sampleBuffer=new t(r),this.$$applyWindowFunction=!!n,this.$$frequencyBin=null},i.$$_UNIT_PHASE=1,i.$$_NEGATIVE_FREQUENCIES_AMPLITUDE_FIX=2,i.$$_PHASE_CORRECTION=.75,i.$$_DECIBEL_POWER_FROM_AMPLITUDE_FACTOR=20,i.$$_DEFAULT_SAMPLE_PER_PERIOD=32,i.$$_DEFAULT_WINDOW_SIZE=1024,i.prototype.$$computeFrequencyBin=function(){var t,r,n,o,a,s,$;for(this.$$frequencyBin=e.zero(),t=this.$$sampleBuffer.getSize(),r=0;r<t;r++)n=this.$$firstSampleOfBufferNumber+r,o=this.$$cyclePerSample*n,a=e.polar(-o),s=this.$$sampleBuffer.getItem(r),a.multiplyScalar(s),this.$$applyWindowFunction&&($=i.blackman(r,t),a.multiplyScalar($)),this.$$frequencyBin.add(a)},i.prototype.setSamplePerPeriod=function(e){this.$$cyclePerSample=1/e,this.$$firstSampleOfBufferNumber=0,this.$$frequencyBin=null},i.prototype.setWindowSize=function(e){this.$$sampleBuffer.setSizeMax(e),this.$$firstSampleOfBufferNumber=0,this.$$frequencyBin=null},i.prototype.enableWindowFunction=function(){this.$$applyWindowFunction=!0,this.$$frequencyBin=null},i.prototype.disableWindowFunction=function(){this.$$applyWindowFunction=!1,this.$$frequencyBin=null},i.prototype.handle=function(e){this.$$sampleBuffer.isFull()&&this.$$firstSampleOfBufferNumber++,this.$$sampleBuffer.pushEvenIfFull(e),this.$$frequencyBin=null},i.prototype.getAmplitude=function(){var e,t,r;return this.$$frequencyBin||this.$$computeFrequencyBin(),e=this.$$frequencyBin.getMagnitude(),t=e/this.$$sampleBuffer.getSize(),r=t*i.$$_NEGATIVE_FREQUENCIES_AMPLITUDE_FIX},i.prototype.getUnitPhase=function(){var e,t,r;return this.$$frequencyBin||this.$$computeFrequencyBin(),e=this.$$frequencyBin.getUnitAngle(),t=e-i.$$_PHASE_CORRECTION,t=t<0?t+i.$$_UNIT_PHASE:t,t=i.$$_UNIT_PHASE-t,r=t%i.$$_UNIT_PHASE},i.prototype.getDecibel=function(){var e,t;return this.$$frequencyBin||this.$$computeFrequencyBin(),t=this.getAmplitude(),e=i.$$_DECIBEL_POWER_FROM_AMPLITUDE_FACTOR*Math.log(t)/Math.LN10},i.prototype.getFrequencyBin=function(){return this.$$frequencyBin||this.$$computeFrequencyBin(),this.$$frequencyBin.clone()},i.blackmanNuttall=function(e,t){return.3635819-.4891775*Math.cos(2*Math.PI*e/(t-1))+.1365995*Math.cos(4*Math.PI*e/(t-1))-.0106411*Math.cos(6*Math.PI*e/(t-1))},i.blackman=function(e,t){var i=.16,r=.5*(1-i),n=.5,o=.5*i;return r-n*Math.cos(2*Math.PI*e/(t-1))+o*Math.cos(4*Math.PI*e/(t-1))},i}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.WaveAnalyser",e),e.$inject=["Rewrite.Dsp.Complex","Rewrite.Util.Buffer"]}(),function(){function e(){var e;return e=function(t){t=t||e.$$_DEFAULT_SAMPLE_PER_PERIOD,this.$$omega=null,this.$$sampleNumber=null,this.setSamplePerPeriod(t),this.$$phase=e.NO_PHASE_SHIFT,this.$$amplitude=e.UNIT_AMPLITUDE,this.$$sample=null},e.UNIT_AMPLITUDE=1,e.NO_PHASE_SHIFT=0,e.$$_DEFAULT_SAMPLE_PER_PERIOD=32,e.prototype.$$computeSample=function(){var e;e=this.$$omega*this.$$sampleNumber,this.$$sample=this.$$amplitude*Math.sin(e-this.$$phase)},e.prototype.setSamplePerPeriod=function(e){this.$$omega=2*Math.PI/e,this.$$sampleNumber=0},e.prototype.setUnitPhase=function(e){this.$$phase=2*Math.PI*e},e.prototype.setAmplitude=function(e){this.$$amplitude=e},e.prototype.nextSample=function(){this.$$sampleNumber++,this.$$sample=null},e.prototype.getSample=function(){return null===this.$$sample&&this.$$computeSample(),this.$$sample},e}AudioNetwork.Injector.registerFactory("Rewrite.Dsp.WaveGenerator",e),e.$inject=[]}(),function(){function e(e){var t;return t=function(){this._fftSize=8192,this._unitTime=.25,this._fftSkipFactor=3,this._microphoneMode=e.MICROPHONE_MODE_ALWAYS_ON,this._samplePerSymbol=2,this._symbolMin44100=114,this._symbolMin48000=82,this._symbolMinDefault=1,this._symbolRange=258,this._correlationCode=[1,-1,1,-1],this._txSampleRate=44100,this._txAmplitude=.2,this._rxSignalDecibelThresholdFactor=.6,this._rxSymbolListener=void 0,this._rxSyncStatusListener=void 0,this._rxSampleDspDetailsListener=void 0,this._rxSyncDspDetailsListener=void 0,this._rxDspConfigListener=void 0,this._dspConfigListener=void 0,this._txSymbolListener=void 0,this._txSymbolProgressListener=void 0,this._txDspConfigListener=void 0},t.prototype.fftSize=function(e){return this._fftSize=e,this},t.prototype.unitTime=function(e){return this._unitTime=e,this},t.prototype.fftSkipFactor=function(e){return this._fftSkipFactor=e,this},t.prototype.microphoneMode=function(e){return this._microphoneMode=e,this},t.prototype.samplePerSymbol=function(e){return this._samplePerSymbol=e,this},t.prototype.symbolMin44100=function(e){return this._symbolMin44100=e,this},t.prototype.symbolMin48000=function(e){return this._symbolMin48000=e,this},t.prototype.symbolMinDefault=function(e){return this._symbolMinDefault=e,this},t.prototype.symbolRange=function(e){return this._symbolRange=e,this},t.prototype.txAmplitude=function(e){return this._txAmplitude=e,this},t.prototype.rxSymbolListener=function(e){return this._rxSymbolListener=e,this},t.prototype.rxSyncStatusListener=function(e){return this._rxSyncStatusListener=e,this},t.prototype.rxSampleDspDetailsListener=function(e){return this._rxSampleDspDetailsListener=e,this},t.prototype.rxSyncDspDetailsListener=function(e){return this._rxSyncDspDetailsListener=e,this},t.prototype.rxDspConfigListener=function(e){return this._rxDspConfigListener=e,this},t.prototype.dspConfigListener=function(e){return this._dspConfigListener=e,this},t.prototype.txSymbolListener=function(e){return this._txSymbolListener=e,this},t.prototype.txSymbolProgressListener=function(e){return this._txSymbolProgressListener=e,this},t.prototype.txDspConfigListener=function(e){return this._txDspConfigListener=e,this},t.prototype.build=function(){return new e(this)},t}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.PhysicalLayerBuilder",e),e.$inject=["Rewrite.PhysicalLayer.PhysicalLayer"]}(),function(){function e(e,t,i,r,n){var o;return o=function(r){this.$$fftSize=r._fftSize,this.$$audioMonoIO=new e(this.$$fftSize),this.$$unitTime=r._unitTime,this.$$smartTimer=new t(this.$$unitTime),this.$$smartTimer.setListener(this.$$smartTimerListener.bind(this)),this.$$fftSkipFactor=r._fftSkipFactor,this.$$samplePerSymbol=r._samplePerSymbol,this.$$symbolMin44100=r._symbolMin44100,this.$$symbolMin48000=r._symbolMin48000,this.$$symbolMinDefault=r._symbolMinDefault,this.$$symbolRange=r._symbolRange,this.$$rxSampleRate=this.$$audioMonoIO.getSampleRate(),this.$$txAmplitude=r._txAmplitude,this.$$correlationCode=r._correlationCode.slice(0),this.$$rxSyncDetector=new i(this.$$samplePerSymbol,this.$$correlationCode),this.$$rxSignalDecibelThresholdFactor=r._rxSignalDecibelThresholdFactor,this.$$sampleNumber=o.$$_INITIAL_SAMPLE_NUMER,this.$$sampleOffset=void 0,this.$$rxSymbolId=o.$$_INITIAL_ID,this.$$rxSampleDspDetailsId=o.$$_INITIAL_ID,this.$$rxSyncStatusId=o.$$_INITIAL_ID,this.$$rxSymbol=void 0,this.$$rxSymbolRaw=void 0,this.$$rxSignalDecibel=void 0,this.$$rxSignalDecibelNextCandidate=void 0,this.$$rxNoiseDecibel=void 0,this.$$rxFrequencyData=void 0,this.$$isRxSyncInProgress=void 0,this.$$isRxSymbolSamplingPoint=void 0,this.$$rxSignalDecibelThreshold=o.$$_INITIAL_RX_SIGNAL_DECIBEL_THRESHOLD,this.$$rxSyncDspDetailsLastId=void 0,this.$$txSymbolManager=new n,this.$$rxSymbolMin=this.$$getSymbolMin(this.$$rxSampleRate),this.$$rxSymbolMax=this.$$getSymbolMax(this.$$rxSampleRate),this.$$txSampleRate=void 0,this.$$txSymbolMin=void 0,this.$$txSymbolMax=void 0,this.setTxSampleRate(r._txSampleRate),this.$$rxSymbolListener=o.$$isFunction(r._rxSymbolListener)?r._rxSymbolListener:null,this.$$rxSyncStatusListener=o.$$isFunction(r._rxSyncStatusListener)?r._rxSyncStatusListener:null,this.$$rxSampleDspDetailsListener=o.$$isFunction(r._rxSampleDspDetailsListener)?r._rxSampleDspDetailsListener:null,this.$$rxSyncDspDetailsListener=o.$$isFunction(r._rxSyncDspDetailsListener)?r._rxSyncDspDetailsListener:null,this.$$rxDspConfigListener=o.$$isFunction(r._rxDspConfigListener)?r._rxDspConfigListener:null,this.$$dspConfigListener=o.$$isFunction(r._dspConfigListener)?r._dspConfigListener:null,this.$$txSymbolListener=o.$$isFunction(r._txSymbolListener)?r._txSymbolListener:null,this.$$txSymbolProgressListener=o.$$isFunction(r._txSymbolProgressListener)?r._txSymbolProgressListener:null,this.$$txDspConfigListener=o.$$isFunction(r._txDspConfigListener)?r._txDspConfigListener:null,this.$$firstSmartTimerCall=!0},o.MICROPHONE_MODE_ALWAYS_ON=0,o.MICROPHONE_MODE_AUTO_ON_OFF_WITH_GAP=1,o.$$_INITIAL_SAMPLE_NUMER=0,o.$$_INITIAL_ID=0,o.$$_INITIAL_RX_SIGNAL_DECIBEL_THRESHOLD=+(1/0),o.$$_TX_AMPLITUDE_SILENT=0,o.$$_TX_FREQUENCY_ZERO=0,o.$$_FIRST_SYMBOL=1,o.$$_SYMBOL_SYNC_A_OFFSET=1,o.$$_SYMBOL_SYNC_B_OFFSET=0,o.$$_RX_SYMBOL_IDLE=null,o.SYMBOL_IS_NOT_VALID_EXCEPTION="Symbol is not valid. Please pass number that is inside symbol range.",o.prototype.getRxSampleRate=function(){var e=this.getRxDspConfig();return e.rxSampleRate},o.prototype.txSync=function(){var e,t,i,r;for(this.$$txSymbolManager.handleGapLogicAtStart(),e=0;e<this.$$correlationCode.length;e++)t=this.$$correlationCode[e],i=t===-1?this.$$txSymbolMax-o.$$_SYMBOL_SYNC_A_OFFSET:this.$$txSymbolMax-o.$$_SYMBOL_SYNC_B_OFFSET,this.$$txSymbolManager.addTxFskSymbol(i);r=Math.ceil(this.$$correlationCode.length/2)+1,this.$$txSymbolManager.handleGapLogicAtEndOfSync(r),this.$$txSymbolProgressListener?this.$$txSymbolProgressListener(this.getTxSymbolProgress()):void 0},o.prototype.txSymbol=function(e){var t,i,r,n,a;if(this.$$txSymbolManager.handleGapLogicAtStart(),i=parseInt(e),t="number"==typeof i,r=this.$$txSymbolMin<=i&&i<=this.$$txSymbolMax,n=t&&r,!n)throw o.SYMBOL_IS_NOT_VALID_EXCEPTION;return a=this.$$txSymbolManager.addTxFskSymbol(i),this.$$txSymbolManager.handleGapLogicAtEnd(),this.$$txSymbolProgressListener?this.$$txSymbolProgressListener(this.getTxSymbolProgress()):void 0,a},o.prototype.setTxSampleRate=function(e){this.$$txSampleRate=e,this.$$txSymbolMin=this.$$getSymbolMin(this.$$txSampleRate),this.$$txSymbolMax=this.$$getSymbolMax(this.$$txSampleRate),this.$$txSymbolManager.clearTxSymbolQueue(),this.$$txSymbolProgressListener?this.$$txSymbolProgressListener(this.getTxSymbolProgress()):void 0,this.$$txDspConfigListener?this.$$txDspConfigListener(this.getTxDspConfig()):void 0},o.prototype.setLoopback=function(e){this.$$audioMonoIO.setLoopback(e),this.$$dspConfigListener?this.$$dspConfigListener(this.getDspConfig()):void 0},o.prototype.setTxAmplitude=function(e){this.$$txAmplitude=e,this.$$txDspConfigListener?this.$$txDspConfigListener(this.getTxDspConfig()):void 0},o.prototype.getRxSymbol=function(){return{id:this.$$rxSymbolId,rxSymbol:this.$$rxSymbol,rxSampleDspDetails:this.$$rxSampleDspDetailsId}},o.prototype.getRxSyncStatus=function(){var e=this.$$rxSyncDetector.getRxSyncDspDetails();return{id:this.$$rxSyncStatusId,isRxSyncInProgress:this.$$isRxSyncInProgress,isRxSyncOk:!!e.id,rxSyncDspDetailsId:e.id,rxSampleDspDetailsId:this.$$rxSampleDspDetailsId}},o.prototype.getRxSampleDspDetails=function(){return{id:this.$$rxSampleDspDetailsId,rxSymbolRaw:this.$$rxSymbolRaw,rxSignalDecibel:this.$$rxSignalDecibel,rxNoiseDecibel:this.$$rxNoiseDecibel,rxFrequencyData:this.$$rxFrequencyData.slice(0),isRxSymbolSamplingPoint:this.$$isRxSymbolSamplingPoint,rxSampleNumber:this.$$sampleNumber,rxSampleOffset:this.$$sampleOffset}},o.prototype.getRxSyncDspDetails=function(){var e=this.$$rxSyncDetector.getRxSyncDspDetails();return{id:e.id,rxSymbolSamplingPointOffset:e.rxSymbolSamplingPointOffset,rxCorrelationValue:e.rxCorrelationValue,rxCorrelationCodeLength:e.rxCorrelationCodeLength,rxSignalDecibelAverage:e.rxSignalDecibelAverage,rxNoiseDecibelAverage:e.rxNoiseDecibelAverage,rxSignalToNoiseRatio:e.rxSignalToNoiseRatio}},o.prototype.getRxDspConfig=function(){var e=this.$$getFrequency(o.$$_FIRST_SYMBOL,this.$$rxSampleRate);return{rxSampleRate:this.$$rxSampleRate,rxSymbolFrequencySpacing:e,
rxSymbolMin:this.$$rxSymbolMin,rxSymbolMax:this.$$rxSymbolMax,rxSignalDecibelThreshold:this.$$rxSignalDecibelThreshold,rxSignalDecibelThresholdFactor:this.$$rxSignalDecibelThresholdFactor}},o.prototype.getDspConfig=function(){return{fftSkipFactor:this.$$fftSkipFactor,fftSize:this.$$fftSize,samplePerSymbol:this.$$samplePerSymbol,unitTime:this.$$unitTime,isLoopbackEnabled:this.$$audioMonoIO.isLoopbackEnabled()}},o.prototype.getTxSymbol=function(){return this.$$txSymbolManager.getTxSymbol()},o.prototype.getTxSymbolProgress=function(){return this.$$txSymbolManager.getTxSymbolProgress()},o.prototype.getTxDspConfig=function(){var e=this.$$getFrequency(o.$$_FIRST_SYMBOL,this.$$txSampleRate);return{txSampleRate:this.$$txSampleRate,txSymbolFrequencySpacing:e,txSymbolMin:this.$$txSymbolMin,txSymbolMax:this.$$txSymbolMax,txAmplitude:this.$$txAmplitude}},o.prototype.$$smartTimerListener=function(){this.$$firstSmartTimerCall&&(this.$$rxDspConfigListener?this.$$rxDspConfigListener(this.getRxDspConfig()):void 0,this.$$dspConfigListener?this.$$dspConfigListener(this.getDspConfig()):void 0,this.$$txDspConfigListener?this.$$txDspConfigListener(this.getTxDspConfig()):void 0),this.$$sampleOffset=this.$$sampleNumber%this.$$samplePerSymbol,this.$$rx(),this.$$tx(),this.$$sampleNumber++,this.$$firstSmartTimerCall=!1},o.prototype.$$rx=function(){var e,t,i,n,a,s,$=!1;if(this.$$rxSampleDspDetailsId++,this.$$rxSyncStatusId++,e=this.$$txSymbolManager.getTxSymbolCurrent().isIdle()||this.$$audioMonoIO.isLoopbackEnabled())t=new r(this.$$audioMonoIO.getFrequencyData(),this.$$rxSampleRate),t.downconvert(this.$$fftSkipFactor),this.$$rxFrequencyData=t.getFrequencyData(),this.$$rxSymbolRaw=t.getLoudestBinIndexInBinRange(this.$$rxSymbolMin,this.$$rxSymbolMax),this.$$rxSignalDecibel=t.getDecibel(this.$$rxSymbolRaw),this.$$rxSignalDecibelNextCandidate=-(1/0),this.$$rxNoiseDecibel=t.getDecibelAverage(this.$$rxSymbolMin,this.$$rxSymbolMax,this.$$rxSymbolRaw);else{for(a=[],s=0;s<.5*this.$$fftSize;s++)a.push(-160);t=new r(a,this.$$rxSampleRate),t.downconvert(this.$$fftSkipFactor),this.$$rxFrequencyData=t.getFrequencyData(),this.$$rxSymbolRaw=this.$$rxSymbolMin,this.$$rxSignalDecibel=-(1/0),this.$$rxSignalDecibelNextCandidate=-(1/0),this.$$rxNoiseDecibel=-(1/0)}this.$$handleRxSync(),this.$$isRxSyncInProgress=this.$$rxSyncDetector.isRxSyncInProgress(),i=this.$$rxSyncDetector.getRxSyncDspDetails(),i.id&&i.id!==this.$$rxSyncDspDetailsLastId&&(this.$$rxSignalDecibelThreshold=i.rxNoiseDecibelAverage+this.$$rxSignalDecibelThresholdFactor*i.rxSignalToNoiseRatio,this.$$rxSyncDspDetailsLastId=i.id,$=!0),this.$$isRxSymbolSamplingPoint=i.id>0&&this.$$sampleOffset===i.rxSymbolSamplingPointOffset,n=this.$$isRxSymbolSamplingPoint&&this.$$rxSignalDecibel>this.$$rxSignalDecibelThreshold,this.$$rxSymbol=n?this.$$rxSymbolRaw:o.$$_RX_SYMBOL_IDLE,$&&(this.$$rxSyncDspDetailsListener?this.$$rxSyncDspDetailsListener(this.getRxSyncDspDetails()):void 0,this.$$rxDspConfigListener?this.$$rxDspConfigListener(this.getRxDspConfig()):void 0),this.$$rxSampleDspDetailsListener?this.$$rxSampleDspDetailsListener(this.getRxSampleDspDetails()):void 0,this.$$rxSyncStatusListener?this.$$rxSyncStatusListener(this.getRxSyncStatus()):void 0,this.$$isRxSymbolSamplingPoint&&(this.$$rxSymbolId++,this.$$rxSymbolListener?this.$$rxSymbolListener(this.getRxSymbol()):void 0)},o.prototype.$$tx=function(){var e,t,i=0===this.$$sampleOffset;i&&(e=this.$$txSymbolManager.isTxAboutToStart(),t=this.$$txSymbolManager.isTxAboutToEnd(),this.$$txSymbolManager.tick(),e&&this.$$audioMonoIO.microphoneDisable(),t&&this.$$audioMonoIO.microphoneEnable(),this.$$updateOscillator(),this.$$txSymbolListener?this.$$txSymbolListener(this.getTxSymbol()):void 0,this.$$txSymbolProgressListener?this.$$txSymbolProgressListener(this.getTxSymbolProgress()):void 0)},o.prototype.$$handleRxSync=function(){var e=null;switch(this.$$rxSymbolRaw){case this.$$rxSymbolMax-o.$$_SYMBOL_SYNC_A_OFFSET:e=-1;break;case this.$$rxSymbolMax-o.$$_SYMBOL_SYNC_B_OFFSET:e=1}this.$$rxSyncDetector.handle(e,this.$$rxSignalDecibel,this.$$rxNoiseDecibel)},o.prototype.$$getSymbolMin=function(e){switch(e){case 44100:return this.$$symbolMin44100;case 48e3:return this.$$symbolMin48000;default:return this.$$symbolMinDefault}},o.prototype.$$getSymbolMax=function(e){var t=this.$$getSymbolMin(e);return t+this.$$symbolRange-1},o.prototype.$$updateOscillator=function(){var e,t,i,r;r=this.$$txSymbolManager.getTxSymbolCurrent(),i=r.isFsk(),i?(e=this.$$getFrequency(r.getTxFskSymbol(),this.$$txSampleRate),t=this.$$txAmplitude):(e=o.$$_TX_FREQUENCY_ZERO,t=o.$$_TX_AMPLITUDE_SILENT),this.$$audioMonoIO.setPeriodicWave(e,t)},o.prototype.$$getFrequency=function(e,t){var i=r.getFrequency(e,t,this.$$fftSize);return this.$$fftSkipFactor*i},o.$$isFunction=function(e){return"function"==typeof e},o}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.PhysicalLayer",e),e.$inject=["Rewrite.WebAudio.AudioMonoIO","Rewrite.Util.SmartTimer","Rewrite.PhysicalLayer.RxSyncDetector","Rewrite.Dsp.FFTResult","Rewrite.PhysicalLayer.TxSymbolManager"]}(),function(){function e(e){var t;return t=function(i,r){this.$$samplePerSymbol=i,this.$$rxSyncInProgress=!1,this.$$rxSyncDspDetails=t.$$getEmpty(),this.$$id=t.$$_INITIAL_ID,this.$$correlator=new e(i,r),this.$$blockHistory=void 0,this.$$rxSampleNumber=t.$$_INITIAL_RX_SAMPLE_NUMBER,this.$$initializeBlockHistory()},t.$$_FIRST_ELEMENT=0,t.$$_INITIAL_ID=1,t.$$_INITIAL_RX_SAMPLE_NUMBER=0,t.prototype.isRxSyncInProgress=function(){return this.$$rxSyncInProgress},t.prototype.getRxSyncDspDetails=function(){return this.$$rxSyncDspDetails},t.prototype.handle=function(e,i,r){var n,o,a,s,$,l,c;n=this.$$rxSampleNumber%this.$$samplePerSymbol,o=this.$$blockHistory[n],a=n===this.$$samplePerSymbol-1,this.$$correlator.handle(e,i,r),s=this.$$correlator.isCorrelated(),s&&(c=t.$$getEmpty(),c.rxSymbolSamplingPointOffset=n,c.rxCorrelationValue=this.$$correlator.getCorrelationValue(),c.rxCorrelationCodeLength=this.$$correlator.getCorrelationCodeLength(),c.rxSignalDecibelAverage=this.$$correlator.getSignalDecibelAverage(),c.rxNoiseDecibelAverage=this.$$correlator.getNoiseDecibelAverage(),c.rxSignalToNoiseRatio=this.$$correlator.getSignalToNoiseRatio(),o.decisionList.push(c)),l=o.syncDetected,o.syncJustLost=l&&!s,o.syncDetected=s,a&&($=this.$$tryToUpdateSync()),this.$$rxSyncInProgress=!$&&this.$$isRxSyncInProgressInHistoryBlock(),this.$$rxSampleNumber++},t.prototype.$$sortByCorrelationValue=function(e,t){return e.rxCorrelationValue<t.rxCorrelationValue?1:e.rxCorrelationValue>t.rxCorrelationValue?-1:0},t.prototype.$$sortBySignalDecibel=function(e,t){return e.rxSignalDecibelAverage<t.rxSignalDecibelAverage?1:e.rxSignalDecibelAverage>t.rxSignalDecibelAverage?-1:0},t.prototype.$$sortDecisionList=function(e){var t=this;e.sort(function(e,i){return t.$$sortByCorrelationValue(e,i)||t.$$sortBySignalDecibel(e,i)})},t.prototype.$$initializeBlockHistory=function(){var e;for(this.$$blockHistory=[],e=0;e<this.$$samplePerSymbol;e++)this.$$blockHistory.push({decisionList:[],syncJustLost:void 0,syncDetected:void 0})},t.prototype.$$resetBlockHistory=function(){var e,t;for(e=0;e<this.$$samplePerSymbol;e++)t=this.$$blockHistory[e],t.decisionList.length=0,t.syncJustLost=void 0,t.syncDetected=void 0},t.prototype.$$getTheBestRxSyncDspDetails=function(){var e,i,r,n;for(i=[],e=0;e<this.$$samplePerSymbol;e++)r=this.$$blockHistory[e].decisionList,r.length>0&&(this.$$sortDecisionList(r),i.push(r[t.$$_FIRST_ELEMENT]));return this.$$sortDecisionList(i),n=i[t.$$_FIRST_ELEMENT]},t.prototype.$$updateSync=function(){this.$$rxSyncDspDetails=this.$$getTheBestRxSyncDspDetails(),this.$$rxSyncDspDetails.id=this.$$id++,this.$$resetBlockHistory(),this.$$correlator.reset()},t.prototype.$$tryToUpdateSync=function(){var e;for(e=0;e<this.$$samplePerSymbol;e++)if(this.$$blockHistory[e].syncJustLost)return this.$$updateSync(),!0;return!1},t.prototype.$$isRxSyncInProgressInHistoryBlock=function(){var e,t;for(e=0;e<this.$$samplePerSymbol;e++)if(t=this.$$blockHistory[e],t.syncDetected||t.syncJustLost)return!0;return!1},t.$$getEmpty=function(){return{id:null,rxSymbolSamplingPointOffset:void 0,rxCorrelationValue:void 0,rxCorrelationCodeLength:void 0,rxSignalDecibelAverage:void 0,rxNoiseDecibelAverage:void 0,rxSignalToNoiseRatio:void 0}},t}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.RxSyncDetector",e),e.$inject=["Rewrite.Dsp.Correlator"]}(),function(){function e(e){var t;return t=function(){this.$$txSymbolId=1,this.$$txSymbol=null,this.$$txSymbolCurrent=this.$$getTxSymbolIdle(),this.$$txSymbolQueue=[]},t.prototype.clearTxSymbolQueue=function(){this.$$txSymbolQueue.length=0},t.prototype.getTxSymbol=function(){return this.$$txSymbol.cloneClean()},t.prototype.getTxSymbolCurrent=function(){return this.$$txSymbolCurrent},t.prototype.getTxSymbolProgress=function(){var e,t={};for(t.txSymbolCurrent=this.$$txSymbolCurrent.cloneClean(),t.txSymbolQueue=[],t.isTxInProgress=this.isTxInProgress(),e=0;e<this.$$txSymbolQueue.length;e++)t.txSymbolQueue.push(this.$$txSymbolQueue[e].cloneClean());return t},t.prototype.isTxInProgress=function(){return this.$$txSymbolQueue.length>0||this.$$txSymbolCurrent.isNotIdle()},t.prototype.addTxFskSymbol=function(t){var i=new e((this.$$txSymbolId++),e.TX_SYMBOL_FSK);return i.setTxFskSymbol(t),this.$$txSymbolQueue.push(i),i.getId()},t.prototype.addTxSymbolGapImportant=function(){var t=new e((this.$$txSymbolId++),e.TX_SYMBOL_GAP_IMPORTANT);this.$$txSymbolQueue.push(t)},t.prototype.addTxSymbolGapDeletable=function(){var t=new e((this.$$txSymbolId++),e.TX_SYMBOL_GAP_DELETABLE);this.$$txSymbolQueue.push(t)},t.prototype.$$getTxSymbolIdle=function(){return new e((this.$$txSymbolId++),e.TX_SYMBOL_IDLE)},t.prototype.isTxAboutToStart=function(){var e=0!==this.$$txSymbolQueue.length;return this.$$txSymbolCurrent.isIdle()&&e},t.prototype.isTxAboutToEnd=function(){var e=0===this.$$txSymbolQueue.length;return e&&this.$$txSymbolCurrent.isNotIdle()},t.prototype.tick=function(){var e,t;t=0===this.$$txSymbolQueue.length,this.$$txSymbol=this.$$txSymbolCurrent,t?(e=this.$$getTxSymbolIdle(),this.$$txSymbolCurrent=e):this.$$txSymbolCurrent=this.$$txSymbolQueue.shift()},t.prototype.handleGapLogicAtStart=function(){this.isTxInProgress()?this.$$clearAllDeletableGapFromTheEndOfTheQueue():(this.addTxSymbolGapDeletable(),this.addTxSymbolGapDeletable())},t.prototype.handleGapLogicAtEnd=function(){this.addTxSymbolGapDeletable()},t.prototype.handleGapLogicAtEndOfSync=function(e){var t;for(t=0;t<e;t++)this.addTxSymbolGapImportant()},t.prototype.$$clearAllDeletableGapFromTheEndOfTheQueue=function(){var e;for(e=this.$$txSymbolQueue.length-1;e>=0;e--)if(this.$$txSymbolQueue[e].isNotGapDeletable()){this.$$txSymbolQueue.length=e+1;break}},t}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.TxSymbolManager",e),e.$inject=["Rewrite.PhysicalLayer.TxSymbol"]}(),function(){function e(){var e;return e=function(e,t){this.$$id=e,this.$$txSymbolType=t,this.$$txFskSymbol=null},e.TX_SYMBOL_IDLE="TX_SYMBOL_IDLE",e.TX_SYMBOL_GAP_IMPORTANT="TX_SYMBOL_GAP_IMPORTANT",e.TX_SYMBOL_GAP_DELETABLE="TX_SYMBOL_GAP_DELETABLE",e.TX_SYMBOL_FSK="TX_SYMBOL_FSK",e.prototype.setTxFskSymbol=function(e){this.$$txFskSymbol=e},e.prototype.cloneClean=function(){return{id:this.$$id,txSymbolType:this.$$txSymbolType,txFskSymbol:this.$$txFskSymbol}},e.prototype.isNotIdle=function(){return this.$$txSymbolType!==e.TX_SYMBOL_IDLE},e.prototype.isIdle=function(){return this.$$txSymbolType===e.TX_SYMBOL_IDLE},e.prototype.isFsk=function(){return this.$$txSymbolType===e.TX_SYMBOL_FSK},e.prototype.isNotGapDeletable=function(){return this.$$txSymbolType!==e.TX_SYMBOL_GAP_DELETABLE},e.prototype.getId=function(){return this.$$id},e.prototype.getTxFskSymbol=function(){return this.$$txFskSymbol},e}AudioNetwork.Injector.registerFactory("Rewrite.PhysicalLayer.TxSymbol",e),e.$inject=[]}(),function(){function e(){var e;return e=function(e){this.$$data=[],this.$$positionStart=null,this.$$positionEnd=null,this.$$size=null,this.$$sizeMax=null,this.setSizeMax(e)},e.prototype.clone=function(){var t,i=new e(this.$$sizeMax),r=this.$$data.length;for(i.$$positionStart=this.$$positionStart,i.$$positionEnd=this.$$positionEnd,i.$$size=this.$$size,t=0;t<r;t++)i[t]=this.$$data[t];return i},e.prototype.setSizeMax=function(e){this.$$positionStart=0,this.$$positionEnd=0,this.$$size=0,this.$$sizeMax=e,this.$$data.length=0,this.$$data.length=e},e.prototype.push=function(e){return this.$$size!==this.$$sizeMax&&(this.$$data[this.$$positionEnd]=e,this.$$positionEnd=(this.$$positionEnd+1)%this.$$sizeMax,this.$$size++,!0)},e.prototype.pushEvenIfFull=function(e){this.isFull()&&this.pop(),this.push(e)},e.prototype.pop=function(){var e;return 0===this.$$size?null:(e=this.$$data[this.$$positionStart],this.$$positionStart=(this.$$positionStart+1)%this.$$sizeMax,this.$$size--,e)},e.prototype.getItem=function(e){return e>=this.$$size||e<0?null:this.$$data[(this.$$positionStart+e)%this.$$sizeMax]},e.prototype.getSize=function(){return this.$$size},e.prototype.getSizeMax=function(){return this.$$sizeMax},e.prototype.isFull=function(){return this.$$size===this.$$sizeMax},e.prototype.getAll=function(){var e,t=[];for(e=0;e<this.getSize();e++)t.push(this.getItem(e));return t},e.prototype.fillWith=function(e){var t;for(t=0;t<this.getSizeMax();t++)this.pushEvenIfFull(e)},e}AudioNetwork.Injector.registerFactory("Rewrite.Util.Buffer",e),e.$inject=[]}(),function(){function e(){var e;return e=function(t,i){if(this.$$sampleRateProvider=t?t:null,this.$$windowSizeProvider=i?i:null,!this.$$sampleRateProvider||!this.$$windowSizeProvider)throw e.PLEASE_SET_BOTH_PROVIDERS},e.PLEASE_SET_BOTH_PROVIDERS="Please set both providers",e.$$isFunction=function(e){return"function"==typeof e},e.prototype.getSamplePerPeriodFromHertz=function(t){var i;return i=e.$$isFunction(this.$$sampleRateProvider)?this.$$sampleRateProvider():this.$$sampleRateProvider,i/t},e.prototype.getHertzFromSamplePerPeriod=function(t){var i;return i=e.$$isFunction(this.$$sampleRateProvider)?this.$$sampleRateProvider():this.$$sampleRateProvider,i/t},e.prototype.getCyclePerWindowFromHertz=function(t){var i,r;return i=e.$$isFunction(this.$$windowSizeProvider)?this.$$windowSizeProvider():this.$$windowSizeProvider,r=e.$$isFunction(this.$$sampleRateProvider)?this.$$sampleRateProvider():this.$$sampleRateProvider,t*i/r},e.prototype.getHertzFromCyclePerWindow=function(t){var i,r;return i=e.$$isFunction(this.$$windowSizeProvider)?this.$$windowSizeProvider():this.$$windowSizeProvider,r=e.$$isFunction(this.$$sampleRateProvider)?this.$$sampleRateProvider():this.$$sampleRateProvider,t*r/i},e.prototype.getSamplePerPeriodFromCyclePerWindow=function(t){var i;return i=e.$$isFunction(this.$$windowSizeProvider)?this.$$windowSizeProvider():this.$$windowSizeProvider,i/t},e.prototype.getCyclePerWindowFromSamplePerPeriod=function(t){var i;return i=e.$$isFunction(this.$$windowSizeProvider)?this.$$windowSizeProvider():this.$$windowSizeProvider,i/t},e}AudioNetwork.Injector.registerFactory("Rewrite.Util.FrequencyCalculator",e),e.$inject=[]}(),function(){function e(){var e;return e=function(t){this.$$a4Frequency=t?t:e.A4_FREQUENCY_DEFAULT},e.C4_A4_DELTA=9,e.A4_FREQUENCY_DEFAULT=440,e.SEMITONE_PER_OCTAVE=12,e.OCTAVE_MIN=0,e.OCTAVE_HOLDING_A4=4,e.OCTAVE_MAX=10,e.NOTE_NAME_LIST=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],e.prototype.getSemitoneNumber=function(t){var i,r;return t<=0?null:(i=Math.log(t/this.$$a4Frequency)/Math.log(2),r=Math.round(e.SEMITONE_PER_OCTAVE*i+e.C4_A4_DELTA),e.$$checkSemitoneNumberRange(r),r)},e.prototype.getFrequency=function(t){var i,r;return e.$$checkSemitoneNumberRange(t),i=t-e.C4_A4_DELTA,r=i/e.SEMITONE_PER_OCTAVE,this.$$a4Frequency*Math.pow(2,r)},e.prototype.getNoteName=function(t){return e.getNoteName(t)},e.getNoteName=function(t){var i,r,n,o;return e.$$checkSemitoneNumberRange(t),i=e.OCTAVE_HOLDING_A4*e.SEMITONE_PER_OCTAVE,r=i+t,n=Math.floor(r/e.SEMITONE_PER_OCTAVE),o=r%e.SEMITONE_PER_OCTAVE,e.NOTE_NAME_LIST[o]+n},e.prototype.getFirstSemitoneNumber=function(t){return e.getFirstSemitoneNumber(t)},e.getFirstSemitoneNumber=function(t){var i;return t<0?null:(i=t-e.OCTAVE_HOLDING_A4,i*e.SEMITONE_PER_OCTAVE)},e.$$checkSemitoneNumberRange=function(e){},e}AudioNetwork.Injector.registerFactory("Rewrite.Util.MusicCalculator",e),e.$inject=[]}(),function(){function e(){var e;return e=function(e){this.$$interval=null,this.$$intervalCounter=null,this.$$timeRefference=null,this.$$timeoutId=null,this.$$listener=void 0,this.setInterval(e)},e.$$_MILISECOND_IN_SECOND=1e3,e.$$isFunction=function(e){return"function"==typeof e},e.prototype.setInterval=function(e){null!==this.$$timeoutId&&clearTimeout(this.$$timeoutId),this.$$interval=e,this.$$intervalCounter=0,this.$$timeRefference=new Date,this.$$scheduleNext()},e.prototype.setListener=function(t){e.$$isFunction(t)?this.$$listener=t.bind(t):this.$$listener=null},e.prototype.$$scheduleNext=function(){var t,i,r=new Date(this.$$timeRefference),n=new Date;this.$$intervalCounter++,t=e.$$_MILISECOND_IN_SECOND*this.$$interval*this.$$intervalCounter,r.setMilliseconds(r.getMilliseconds()+t),i=r.getTime()-n.getTime(),this.$$timeoutId=setTimeout(this.$$notifyListener.bind(this),i)},e.prototype.$$notifyListener=function(){this.$$listener&&this.$$listener(),this.$$scheduleNext()},e}AudioNetwork.Injector.registerFactory("Rewrite.Util.SmartTimer",e),e.$inject=[]}(),function(){function e(){var e;return e=function(){},e.$$_MONO_CHANNEL_COUNT=1,e.$$writeString=function(e,t,i){var r;for(r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))},e.$$clipToUnit=function(e){return e=e<-1?-1:e,e=e>1?1:e},e.$$floatTo16BitPCM=function(t,i,r){var n,o,a;for(n=0;n<r.length;n++)o=e.$$clipToUnit(r[n]),a=o<0?32768*o:32767*o,t.setInt16(i,a,!0),i+=2},e.$$getObjectUrl=function(e){return(window.URL||window.webkitURL).createObjectURL(e)},e.$$pad=function(e,t){var i="000000"+e;return i.substr(i.length-t)},e.getFilename=function(){var t,i=new Date;return t=""+i.getFullYear()+e.$$pad(i.getMonth()+1,2)+e.$$pad(i.getDate(),2)+"_"+e.$$pad(i.getHours(),2)+e.$$pad(i.getMinutes(),2)+e.$$pad(i.getSeconds(),2)+"_"+e.$$pad(i.getMilliseconds(),3)+".wav"},e.getBlobUrl=function(t,i){var r,n=new ArrayBuffer(44+2*t.length),o=new DataView(n);return e.$$writeString(o,0,"RIFF"),o.setUint32(4,36+2*t.length,!0),e.$$writeString(o,8,"WAVE"),e.$$writeString(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,e.$$_MONO_CHANNEL_COUNT,!0),o.setUint32(24,i,!0),o.setUint32(28,4*i,!0),o.setUint16(32,2*e.$$_MONO_CHANNEL_COUNT,!0),o.setUint16(34,16,!0),e.$$writeString(o,36,"data"),o.setUint32(40,2*t.length,!0),e.$$floatTo16BitPCM(o,44,t),r=new Blob([o],{type:"audio/wav"}),e.$$getObjectUrl(r)},e}AudioNetwork.Injector.registerFactory("Rewrite.Util.WavAudioFile",e),e.$inject=[]}(),function(){function e(){var e;return e=function(t){this.$$audioContext=null,this.$$microphone=null,this.$$microphoneVirtual=null,this.$$sampleInProcessor=null,this.$$sampleOutProcessor=null,this.$$volume=null,this.$$bufferSize=e.$$getValueOrDefault(t,e.BUFFER_SIZE),this.$$loopback=!1,this.$$sampleInHandler=null,this.$$sampleOutHandler=null,this.$$initialize()},e.$$firstInstance=!0,e.$$_MONO=1,e.$$_MONO_INDEX=0,e.$$_NO_CHANNEL=0,e.BUFFER_SIZE=4096,e.prototype.$$initialize=function(){this.$$normalizeBrowserApi(),this.$$audioContext=this.$$createAudioContext(),this.$$microphoneVirtual=this.$$audioContext.createGain(),this.$$volume=this.$$audioContext.createGain(),this.$$volume.connect(this.$$audioContext.destination)},e.prototype.$$normalizeBrowserApi=function(){e.$$firstInstance&&(this.$$crossBrowserAudioContext(),this.$$crossBrowserMediaDevices(),e.$$firstInstance=!1)},e.prototype.$$crossBrowserAudioContext=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext},e.prototype.$$crossBrowserMediaDevices=function(){var e;void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){return e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,e?new Promise(function(i,r){e.call(navigator,t,i,r)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))})},e.prototype.$$logAndRethrow=function(e,t){throw alert(t),console.log(e),e},e.prototype.$$createAudioContext=function(){var e;try{e=new window.AudioContext}catch(t){this.$$logAndRethrow(t,"AudioContext creation failed")}return e},e.prototype.$$connectMicrophoneTo=function(e){var t=this,i={video:!1,audio:!0};navigator.mediaDevices.getUserMedia(i).then(function(i){t.$$microphone=t.$$audioContext.createMediaStreamSource(i),t.$$microphone.connect(e)})["catch"](function(e){t.$$logAndRethrow(e,"Microphone initialization failed")})},e.prototype.$$onAudioProcessInHandler=function(t){var i;e.$$isFunction(this.$$sampleInHandler)&&(i=t.inputBuffer.getChannelData(e.$$_MONO_INDEX),this.$$sampleInHandler(i))},e.prototype.$$onAudioProcessOutHandler=function(t){var i;e.$$isFunction(this.$$sampleOutHandler)&&(i=t.outputBuffer.getChannelData(e.$$_MONO_INDEX),this.$$sampleOutHandler(i))},e.$$isFunction=function(e){return"function"==typeof e},e.$$getValueOrDefault=function(e,t){return"undefined"!=typeof e?e:t},e.prototype.$$setImmediately=function(e,t){var i=this.$$audioContext.currentTime;e.value=t,e.setValueAtTime(t,i)},e.prototype.setLoopback=function(e){this.$$loopback!==!!e&&(this.$$lazyLoadSampleInProcessor(),this.$$loopback?(this.$$volume.disconnect(this.$$sampleInProcessor),this.$$volume.connect(this.$$audioContext.destination),this.$$microphoneVirtual.connect(this.$$sampleInProcessor)):(this.$$microphoneVirtual.disconnect(this.$$sampleInProcessor),this.$$volume.disconnect(this.$$audioContext.destination),this.$$volume.connect(this.$$sampleInProcessor)),this.$$loopback=!!e)},e.prototype.setVolume=function(e){this.$$setImmediately(this.$$volume.gain,e)},e.prototype.$$lazyLoadSampleInProcessor=function(){this.$$sampleInProcessor||(this.$$sampleInProcessor=this.$$audioContext.createScriptProcessor(this.$$bufferSize,e.$$_MONO,e.$$_MONO),this.$$sampleInProcessor.onaudioprocess=this.$$onAudioProcessInHandler.bind(this),this.$$sampleInProcessor.connect(this.$$audioContext.destination),this.$$microphoneVirtual.connect(this.$$sampleInProcessor),this.$$connectMicrophoneTo(this.$$microphoneVirtual))},e.prototype.$$lazyLoadSampleOutProcessor=function(){this.$$sampleOutProcessor||(this.$$sampleOutProcessor=this.$$audioContext.createScriptProcessor(this.$$bufferSize,e.$$_NO_CHANNEL,e.$$_MONO),this.$$sampleOutProcessor.onaudioprocess=this.$$onAudioProcessOutHandler.bind(this),this.$$sampleOutProcessor.connect(this.$$volume))},e.prototype.setSampleInHandler=function(t){e.$$isFunction(t)?(this.$$lazyLoadSampleInProcessor(),this.$$sampleInHandler=t.bind(t)):this.$$sampleInHandler=null},e.prototype.setSampleOutHandler=function(t){e.$$isFunction(t)?(this.$$lazyLoadSampleOutProcessor(),this.$$sampleOutHandler=t.bind(t)):this.$$sampleOutHandler=null},e.prototype.getSampleRate=function(){return this.$$audioContext.sampleRate},e}AudioNetwork.Injector.registerFactory("Rewrite.WebAudio.AudioMonoIOLite",e),e.$inject=[]}(),function(){function e(){var e;return e=function(t,i,r){this.$$audioContext=null,this.$$microphoneStream=null,this.$$microphone=null,this.$$microphoneVirtual=null,this.$$masterIn=null,this.$$masterOut=null,this.$$masterOutVolume=null,this.$$sampleProcessor=null,this.$$inAnalyzer=null,this.$$outOscillator=null,this.$$outOscillatorGain=null,this.$$fftSize=e.$$getValueOrDefault(t,e.FFT_SIZE),this.$$bufferSize=e.$$getValueOrDefault(i,e.BUFFER_SIZE),this.$$smoothingTimeConstant=e.$$getValueOrDefault(r,e.SMOOTHING_TIME_CONSTANT),this.$$sampleInHandler=null,this.$$sampleOutHandler=null,this.$$loopbackEnabled=!1,this.$$initialize()},e.$$firstInstance=!0,e.$$_MONO=1,e.$$_MONO_INDEX=0,e.$$_OUTPUT_WAVE_FREQUENCY=0,e.$$_OUTPUT_WAVE_VOLUME=1,e.$$_OUTPUT_WAVE_PHASE=0,e.$$_OUTPUT_WAVE_HARMONIC_AMPLITUDE=[1],e.$$_OUTPUT_WAVE_HARMONIC_PHASE=[0],e.FFT_SIZE=2048,e.BUFFER_SIZE=4096,e.SMOOTHING_TIME_CONSTANT=0,e.START_TIME_NEEDS_TO_GREATER_THAN_END_TIME_EXCEPTION="Start time needs to greater than end time",e.prototype.$$normalizeBrowserApi=function(){e.$$firstInstance&&(this.$$crossBrowserAudioContext(),this.$$crossBrowserMediaDevices(),e.$$firstInstance=!1)},e.prototype.$$initialize=function(){this.$$normalizeBrowserApi(),this.$$audioContext=this.$$createAudioContext(),this.$$initializeCommon(),this.$$initializeInput(),this.$$initializeOutput(),this.$$sourceAttach(),this.$$masterOutVolume.connect(this.$$audioContext.destination)},e.prototype.$$sourceDetach=function(){this.$$loopbackEnabled?this.$$masterOut.disconnect(this.$$masterIn):this.$$microphoneVirtual.disconnect(this.$$masterIn)},e.prototype.$$sourceAttach=function(){this.$$loopbackEnabled?this.$$masterOut.connect(this.$$masterIn):this.$$microphoneVirtual.connect(this.$$masterIn)},e.prototype.$$initializeCommon=function(){this.$$microphoneVirtual=this.$$audioContext.createGain(),this.$$connectMicrophoneTo(this.$$microphoneVirtual),this.$$masterIn=this.$$audioContext.createGain(),this.$$masterOut=this.$$audioContext.createGain(),this.$$masterOutVolume=this.$$audioContext.createGain(),this.$$sampleProcessor=this.$$audioContext.createScriptProcessor(this.$$bufferSize,e.$$_MONO,e.$$_MONO),this.$$sampleProcessor.onaudioprocess=this.$$onAudioProcessHandler.bind(this),this.$$masterIn.connect(this.$$sampleProcessor),this.$$sampleProcessor.connect(this.$$masterOut),this.$$masterOut.connect(this.$$masterOutVolume)},e.prototype.$$initializeInput=function(){this.$$inAnalyzer=this.$$audioContext.createAnalyser(),this.setFFTSize(this.$$fftSize),this.setSmoothingTimeConstant(this.$$smoothingTimeConstant),this.$$masterIn.connect(this.$$inAnalyzer)},e.prototype.$$initializeOutput=function(){this.$$outOscillator=this.$$audioContext.createOscillator(),this.$$outOscillatorGain=this.$$audioContext.createGain(),this.setPeriodicWave(e.$$_OUTPUT_WAVE_FREQUENCY,e.$$_OUTPUT_WAVE_VOLUME,e.$$_OUTPUT_WAVE_PHASE,e.$$_OUTPUT_WAVE_HARMONIC_AMPLITUDE,e.$$_OUTPUT_WAVE_HARMONIC_PHASE),this.$$outOscillator.start(),this.$$outOscillator.connect(this.$$outOscillatorGain),this.$$outOscillatorGain.connect(this.$$masterOut)},e.prototype.$$crossBrowserAudioContext=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext},e.prototype.$$crossBrowserMediaDevices=function(){var e;void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){return e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,e?new Promise(function(i,r){e.call(navigator,t,i,r)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))})},e.prototype.$$logAndRethrow=function(e,t){throw alert(t),console.log(e),e},e.prototype.$$createAudioContext=function(){var e;try{e=new window.AudioContext}catch(t){this.$$logAndRethrow(t,"AudioContext creation failed")}return e},e.prototype.$$connectMicrophoneTo=function(e){var t=this,i={video:!1,audio:!0};navigator.mediaDevices.getUserMedia(i).then(function(i){t.$$microphoneStream=i,t.$$microphone=t.$$audioContext.createMediaStreamSource(i),t.$$microphone.connect(e)})["catch"](function(e){t.$$logAndRethrow(e,"Microphone initialization failed")})},e.prototype.$$onAudioProcessHandler=function(t){var i,r;i=t.inputBuffer.getChannelData(e.$$_MONO_INDEX),r=t.outputBuffer.getChannelData(e.$$_MONO_INDEX),e.$$isFunction(this.$$sampleInHandler)&&this.$$sampleInHandler(i),e.$$isFunction(this.$$sampleOutHandler)&&this.$$sampleOutHandler(r,i)},e.prototype.$$setLinearly=function(t,i,r,n){var o=this.$$audioContext.currentTime;if(r>=n)throw e.START_TIME_NEEDS_TO_GREATER_THAN_END_TIME_EXCEPTION;t.setValueAtTime(t.value,o+r),t.linearRampToValueAtTime(i,o+n)},e.prototype.$$setImmediately=function(e,t){var i=this.$$audioContext.currentTime;e.value=t,e.setValueAtTime(t,i)},e.$$isFunction=function(e){return"function"==typeof e},e.$$getValueOrDefault=function(e,t){return"undefined"!=typeof e?e:t},e.prototype.microphoneDisable=function(){var e;this.$$microphone&&(this.$$microphone.disconnect(this.$$microphoneVirtual),this.$$microphone=null,this.$$microphoneStream&&"function"==typeof this.$$microphoneStream.getTracks&&(e=this.$$microphoneStream.getTracks(),e&&e.length>0&&"function"==typeof e[0].stop&&(e[0].stop(),this.$$microphoneStream=null)))},e.prototype.microphoneEnable=function(){this.$$connectMicrophoneTo(this.$$microphoneVirtual)},e.prototype.setVolume=function(e){this.$$setImmediately(this.$$masterOutVolume.gain,e)},e.prototype.isLoopbackEnabled=function(){return this.$$loopbackEnabled},e.prototype.setLoopback=function(e){return e=!!e,this.$$loopbackEnabled!==e&&(this.$$sourceDetach(),this.$$loopbackEnabled=e,this.$$sourceAttach(),!0)},e.prototype.setPeriodicWaveFading=function(e,t,i){this.$$setLinearly(this.$$outOscillatorGain.gain,e,t,i)},e.prototype.setPeriodicWave=function(t,i,r,n,o){var a,s;s="undefined"==typeof r&&"undefined"==typeof n&&"undefined"==typeof o,t=e.$$getValueOrDefault(t,e.$$_OUTPUT_WAVE_FREQUENCY),i=e.$$getValueOrDefault(i,e.$$_OUTPUT_WAVE_VOLUME),(i||0===i)&&this.$$setImmediately(this.$$outOscillatorGain.gain,i),(t||0===t)&&this.$$setImmediately(this.$$outOscillator.frequency,t),s?this.$$outOscillator.type="sine":(r=e.$$getValueOrDefault(r,e.$$_OUTPUT_WAVE_PHASE),n=e.$$getValueOrDefault(n,e.$$_OUTPUT_WAVE_HARMONIC_AMPLITUDE),o=e.$$getValueOrDefault(o,e.$$_OUTPUT_WAVE_HARMONIC_PHASE),a=this.$$getPeriodicWave(r,n,o),this.$$outOscillator.setPeriodicWave(a))},e.prototype.$$getPeriodicWave=function(e,t,i){var r,n,o,a,s,$,l;if(t.length!==i.length)throw"Length of amplitude and phase arrays should match";if(t.length<1)throw"Amplitude and phase arrays should have at least one item";for(r=new Float32Array(1+t.length),n=new Float32Array(1+t.length),s=2*Math.PI*-e,r[0]=0,n[0]=0,a=0;a<t.length;a++)o=1+a,$=2*Math.PI*-i[a],l=s*o+$,r[o]=t[a]*Math.sin(l),n[o]=t[a]*Math.cos(l);return this.$$audioContext.createPeriodicWave(r,n)},e.prototype.setSampleInHandler=function(t){e.$$isFunction(t)?this.$$sampleInHandler=t.bind(t):this.$$sampleInHandler=null},e.prototype.setSampleOutHandler=function(t){e.$$isFunction(t)?this.$$sampleOutHandler=t.bind(t):this.$$sampleOutHandler=null},e.prototype.setFFTSize=function(e){this.$$fftSize=e,this.$$inAnalyzer.fftSize!==this.$$fftSize&&(this.$$inAnalyzer.fftSize=this.$$fftSize)},e.prototype.getFFTSize=function(){return this.$$fftSize},e.prototype.setSmoothingTimeConstant=function(e){this.$$smoothingTimeConstant=e,this.$$inAnalyzer.smoothingTimeConstant!==this.$$smoothingTimeConstant&&(this.$$inAnalyzer.smoothingTimeConstant=this.$$smoothingTimeConstant)},e.prototype.getFrequencyData=function(){var e;return e=new Float32Array(this.$$inAnalyzer.frequencyBinCount),this.$$inAnalyzer.getFloatFrequencyData(e),e},e.prototype.getTimeDomainData=function(){var e;return e=new Float32Array(this.$$inAnalyzer.fftSize),this.$$inAnalyzer.getFloatTimeDomainData(e),e},e.prototype.getSampleRate=function(){return this.$$audioContext.sampleRate},e.prototype.getFFTResolution=function(){return this.getSampleRate()/audioMonoIO.getFFTSize()},e}AudioNetwork.Injector.registerFactory("Rewrite.WebAudio.AudioMonoIO",e),e.$inject=[]}(),function(){function e(e,t,i){function r(e,r){var n,o,a,s,$;for(a=[],o=t.accessor(e,r+".channel"),s=!!o,o=o?o:[],$=o.length,n=0;n<(s?$:2);n++)a.push({baseFrequency:t.accessor(o[n],"baseFrequency")||(n%2===0?i.CHANNEL_1_FREQUENCY:i.CHANNEL_2_FREQUENCY),ofdmSize:t.accessor(o[n],"ofdmSize")||i.OFDM_SIZE,ofdmFrequencySpacing:t.accessor(o[n],"ofdmFrequencySpacing")||i.OFDM_FREQUENCY_SPACING});return a}function n(n){var o,a=n,s=t.accessor;return o={tx:{bufferSize:a&&a.tx&&"undefined"!=typeof a.tx.bufferSize?a.tx.bufferSize:0,channel:r(a,"tx")},rx:{bufferSize:a&&a.rx&&"undefined"!=typeof a.rx.bufferSize?a.rx.bufferSize:0,channel:r(a,"rx"),input:s(a,"rx.input")||i.RX_INPUT,
notificationPerSecond:s(a,"rx.notificationPerSecond")||i.RX_NOTIFICATION_PER_SECOND,dftWindowTime:s(a,"rx.dftWindowTime")||i.RX_DFT_WINDOW_TIME,spectrum:{elementId:s(a,"rx.spectrum.elementId")||null,color:{axis:s(a,"rx.spectrum.color.axis")||"#444",data:s(a,"rx.spectrum.color.data")||"#888888"},fftSize:s(a,"rx.spectrum.fftSize")||i.RX_SPECTRUM_FFT_SIZE,height:s(a,"rx.spectrum.height")||200},constellationDiagram:{elementId:s(a,"rx.constellationDiagram.elementId")||null,color:{historyPoint:{red:{newest:s(a,"rx.constellationDiagram.color.historyPoint.red.newest")||0,tailNewest:s(a,"rx.constellationDiagram.color.historyPoint.red.tailNewest")||100,tailOldest:s(a,"rx.constellationDiagram.color.historyPoint.red.tailOldest")||180},green:{newest:s(a,"rx.constellationDiagram.color.historyPoint.green.newest")||0,tailNewest:s(a,"rx.constellationDiagram.color.historyPoint.green.tailNewest")||100,tailOldest:s(a,"rx.constellationDiagram.color.historyPoint.green.tailOldest")||200},blue:{newest:s(a,"rx.constellationDiagram.color.historyPoint.blue.newest")||0,tailNewest:s(a,"rx.constellationDiagram.color.historyPoint.blue.tailNewest")||100,tailOldest:s(a,"rx.constellationDiagram.color.historyPoint.blue.tailOldest")||150}},axis:s(a,"rx.constellationDiagram.color.axis")||"green"},historyPointSize:e.round(s(a,"rx.constellationDiagram.historyPointSize")||i.RX_HISTORY_POINT_SIZE),width:s(a,"rx.constellationDiagram.width")||200,height:s(a,"rx.constellationDiagram.height")||200}}}}return{parse:n}}AudioNetwork.Injector.registerService("PhysicalLayer.ConfigurationParser",e),e.$inject=["Common.MathUtil","Common.Util","PhysicalLayer.DefaultConfig"]}(),function(){function e(e,t){var i=4,r=1/i,n=.26,o=.74,a=5,s=r*n,$=s,l=r*o,c=l*a,h=2,u=h/s,p=1/s,d=2.5,f=t.round(d*p),m=f;return{CONSTELLATION_DIAGRAM_DECIBEL_LIMIT:-40,MINIMUM_POWER_DECIBEL:-99,FAKE_NOISE_MAX_AMPLITUDE:.001,CHANNEL_1_FREQUENCY:1070,CHANNEL_2_FREQUENCY:2025,OFDM_SIZE:1,OFDM_FREQUENCY_SPACING_POSITIVE_INTEGER:h,OFDM_FREQUENCY_SPACING:u,SYMBOL_FREQUENCY:p,SYMBOL_FREQUENCY_FACTOR:d,RX_INPUT:e.MICROPHONE,RX_NOTIFICATION_PER_SECOND:f,RX_HISTORY_POINT_SIZE:m,RX_DFT_WINDOW_TIME:$,RX_SPECTRUM_FFT_SIZE:1024,BAUD:i,BAUD_MULTIPLICATIVE_INVERSE:r,FACTOR_SYMBOL:n,FACTOR_GUARD:o,SYNC_DURATION:2,SYMBOL_DURATION:s,GUARD_INTERVAL:l,FACTOR_INTERPACKET_GAP:a,INTERPACKET_GAP:c,PSK_SIZE:2,SYNC_PREAMBLE:!0}}AudioNetwork.Injector.registerService("PhysicalLayer.DefaultConfig",e),e.$inject=["PhysicalLayer.RxInput","Common.MathUtil"]}(),function(){function e(e,t,i,r,n,o,a,s,$,l,c,h){var u;return u=function(e){this.$$configuration=r.parse(e),this.$$channelTransmitManager=null,this.$$channelReceiveManager=null,this.$$currentInput=null,this.$$rxAnalyser=null,this.$$rxAnalyserChart=null,this.$$rxConstellationDiagram=[],this.$$outputTx=void 0,this.$$outputMicrophone=void 0,this.$$outputRecordedAudio=void 0,this.$$rxExternalHandler={callback:null},this.$$rxHandler=o.build(this.$$rxConstellationDiagram,this.$$rxExternalHandler),this.$$initTx(),this.$$initRx(),this.setRxInput(this.$$configuration.rx.input)},u.prototype.$$initTx=function(){this.$$channelTransmitManager=a.build(this.$$configuration.tx.channel,this.$$configuration.tx.bufferSize),this.outputTxEnable(),this.outputMicrophoneDisable(),this.outputRecordedAudioDisable()},u.prototype.$$initConstellationDiagram=function(t,r){var n,o,a,s;for(o=[],a=[],n=0;n<r.ofdmSize;n++){if(s=this.$$configuration.rx.constellationDiagram.elementId,s=s.replace("{{ channelIndex }}",t+""),s=s.replace("{{ ofdmIndex }}",n+""),!document.getElementById(s))throw"Constellation diagram DOM element not found";o.push(e.build(this.$$configuration.rx.constellationDiagram.historyPointSize)),a.push($.build(document.getElementById(s),this.$$configuration.rx.constellationDiagram.width,this.$$configuration.rx.constellationDiagram.height,o[o.length-1],i.CONSTELLATION_DIAGRAM_DECIBEL_LIMIT,this.$$configuration.rx.constellationDiagram.color.axis,this.$$configuration.rx.constellationDiagram.color.historyPoint))}this.$$rxConstellationDiagram.push({constellationDiagram:a,queue:o})},u.prototype.$$initRx=function(){var e,i,r=t.round(c.getSampleRate()*this.$$configuration.rx.dftWindowTime),n=t.round(c.getSampleRate()/this.$$configuration.rx.notificationPerSecond);for(i=0;i<this.$$configuration.rx.channel.length;i++)e=this.$$configuration.rx.channel[i],e.dftWindowSize=r,e.notifyInterval=n,e.notifyHandler=this.$$rxHandler.handle.bind(this.$$rxHandler),this.$$configuration.rx.constellationDiagram.elementId&&this.$$initConstellationDiagram(i,e);if(this.$$channelReceiveManager=s.build(this.$$configuration.rx.channel,this.$$configuration.rx.bufferSize),this.$$rxAnalyser=c.createAnalyser(),this.$$rxAnalyser.fftSize=this.$$configuration.rx.spectrum.fftSize,this.$$rxAnalyser.connect(this.$$channelReceiveManager.getInputNode()),this.$$configuration.rx.spectrum.elementId){if(!document.getElementById(this.$$configuration.rx.spectrum.elementId))throw"Spectrum DOM element not found";this.$$rxAnalyserChart=l.build(document.getElementById(this.$$configuration.rx.spectrum.elementId),this.$$rxAnalyser,this.$$configuration.rx.spectrum.height,this.$$configuration.rx.spectrum.color.data,this.$$configuration.rx.spectrum.color.axis)}},u.prototype.$$getTxInputNode=function(e){var t=null;switch(e){case n.MICROPHONE:t=c.getMicrophoneNode();break;case n.LOOPBACK:t=this.$$channelTransmitManager.getOutputNode();break;case n.RECORDED_AUDIO:t=c.getRecordedAudioNode()}return t},u.prototype.getRxInput=function(){return this.$$currentInput},u.prototype.setRxInput=function(e){var t;this.$$currentInput&&this.$$getTxInputNode(this.$$currentInput).disconnect(this.$$rxAnalyser),t=this.$$getTxInputNode(e),t?(t.connect(this.$$rxAnalyser),this.$$currentInput=e,this.$$currentInput===n.LOOPBACK?this.$$channelTransmitManager.enableFakeNoise():this.$$channelTransmitManager.disableFakeNoise()):this.$$currentInput=null},u.prototype.getTxBufferSize=function(){return this.$$channelTransmitManager.getBufferSize()},u.prototype.getRxBufferSize=function(){return this.$$channelReceiveManager.getBufferSize()},u.prototype.loadRecordedAudio=function(e){return c.loadRecordedAudio(e)},u.prototype.tx=function(e,i){var r,n,o=this.$$channelTransmitManager.getChannel(e),a=[];if(!i)throw"Please specify data to send";for(n=0;n<i.length;n++){if(r=i[n],!r.duration)throw"Tx - duration of all data items should be > 0";a.push({amplitude:"undefined"!=typeof r.amplitude?r.amplitude:1,duration:t.round(c.getSampleRate()*r.duration),phase:"undefined"!=typeof r.phase?r.phase:0})}o.addToQueue(a)},u.prototype.rx=function(e){this.$$rxExternalHandler.callback="function"==typeof e?e:null},u.prototype.getSampleRate=function(){return c.getSampleRate()},u.prototype.destroy=function(){var e,t,i=[];if(this.setRxInput(null),this.$$rxAnalyserChart&&(i.push(this.$$rxAnalyserChart.destroy()),this.$$rxAnalyserChart=null),this.$$rxAnalyser.disconnect(this.$$channelReceiveManager.getInputNode()),this.$$rxConstellationDiagram)for(e=0;e<this.$$rxConstellationDiagram.length;e++)for(t=0;t<this.$$rxConstellationDiagram[e].constellationDiagram.length;t++)i.push(this.$$rxConstellationDiagram[e].constellationDiagram[t].destroy());return this.$$channelReceiveManager.destroy(),this.$$channelReceiveManager=null,this.outputTxDisable(),this.outputRecordedAudioDisable(),this.outputMicrophoneDisable(),this.$$channelTransmitManager.destroy(),this.$$channelTransmitManager=null,this.$$rxHandler.destroy(),h.buildFromList(i)},u.prototype.getOutputTxState=function(){return this.$$outputTx},u.prototype.getOutputMicrophoneState=function(){return this.$$outputMicrophone},u.prototype.getOutputRecordedAudioState=function(){return this.$$outputRecordedAudio},u.prototype.outputTxEnable=function(){this.$$outputTx||this.$$channelTransmitManager.getOutputNode().connect(c.getDestination()),this.$$outputTx=!0},u.prototype.outputTxDisable=function(){this.$$outputTx&&this.$$channelTransmitManager.getOutputNode().disconnect(c.getDestination()),this.$$outputTx=!1},u.prototype.outputMicrophoneEnable=function(){this.$$outputMicrophone||c.getMicrophoneNode().connect(c.getDestination()),this.$$outputMicrophone=!0},u.prototype.outputMicrophoneDisable=function(){this.$$outputMicrophone&&c.getMicrophoneNode().disconnect(c.getDestination()),this.$$outputMicrophone=!1},u.prototype.outputRecordedAudioEnable=function(){this.$$outputRecordedAudio||c.getRecordedAudioNode().connect(c.getDestination()),this.$$outputRecordedAudio=!0},u.prototype.outputRecordedAudioDisable=function(){this.$$outputRecordedAudio&&c.getRecordedAudioNode().disconnect(c.getDestination()),this.$$outputRecordedAudio=!1},u.prototype.getRxCpuLoadData=function(){return this.$$channelReceiveManager.getCpuLoadData()},u.prototype.getTxCpuLoadData=function(){return this.$$channelTransmitManager.getCpuLoadData()},u.prototype.getRxFrequency=function(e,t){return this.$$channelReceiveManager.getChannel(e).getFrequency(t)},u.prototype.getTxFrequency=function(e,t){return this.$$channelTransmitManager.getChannel(e).getFrequency(t)},u.prototype.setRxFrequency=function(e,t,i){this.$$channelReceiveManager.getChannel(e).setFrequency(t,i)},u.prototype.setTxFrequency=function(e,t,i){this.$$channelTransmitManager.getChannel(e).setFrequency(t,i)},u.prototype.getRxPhaseCorrection=function(e,t){return this.$$channelReceiveManager.getChannel(e).getRxPhaseCorrection(t)},u.prototype.getTxPhaseCorrection=function(e,t){return this.$$channelTransmitManager.getChannel(e).getTxPhaseCorrection(t)},u.prototype.setRxPhaseCorrection=function(e,t,i){this.$$channelReceiveManager.getChannel(e).setRxPhaseCorrection(t,i)},u.prototype.setTxPhaseCorrection=function(e,t,i){this.$$channelTransmitManager.getChannel(e).setTxPhaseCorrection(t,i)},u.prototype.getTxChannelSize=function(){return this.$$channelTransmitManager.getChannelSize()},u.prototype.getRxChannelSize=function(){return this.$$channelReceiveManager.getChannelSize()},u.prototype.getTxChannelOfdmSize=function(e){return this.$$channelTransmitManager.getChannel(e).getOfdmSize()},u.prototype.getRxChannelOfdmSize=function(e){return this.$$channelReceiveManager.getChannel(e).getOfdmSize()},u}AudioNetwork.Injector.registerFactory("PhysicalLayer.PhysicalLayer",e),e.$inject=["Common.QueueBuilder","Common.MathUtil","PhysicalLayer.DefaultConfig","PhysicalLayer.ConfigurationParser","PhysicalLayer.RxInput","PhysicalLayer.RxHandlerBuilder","PhysicalLayer.ChannelTransmitManagerBuilder","PhysicalLayer.ChannelReceiveManagerBuilder","Visualizer.ConstellationDiagramBuilder","Visualizer.AnalyserChartBuilder","Audio.ActiveAudioContext","Common.SimplePromiseBuilder"]}(),function(){function e(){return{MICROPHONE:"MICROPHONE",LOOPBACK:"LOOPBACK",RECORDED_AUDIO:"RECORDED_AUDIO"}}AudioNetwork.Injector.registerService("PhysicalLayer.RxInput",e),e.$inject=[]}(),function(){function e(){return{NO_INPUT:"NO_INPUT",IDLE_INIT:"IDLE_INIT",FIRST_SYNC_WAIT:"FIRST_SYNC_WAIT",FIRST_SYNC:"FIRST_SYNC",FATAL_ERROR:"FATAL_ERROR",IDLE:"IDLE",SYMBOL:"SYMBOL",SYNC:"SYNC",GUARD:"GUARD",ERROR:"ERROR"}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.ReceiveAdapterState",e),e.$inject=[]}(),function(){function e(e,t,i){var r;return r=function(i){var n,o,a;for(this.$$physicalLayer=i,this.$$stateMachineManager=[],this.$$packetReceiveHandler=null,this.$$frequencyUpdateHandler=null,this.$$phaseCorrectionUpdateHandler=null,o=this.$$physicalLayer.getRxChannelSize(),n=0;n<o;n++)a=t.build(n,this.$$packetReceiveInternalHandler.bind(this),this.$$frequencyUpdateInternalHandler.bind(this),this.$$phaseCorrectionUpdateInternalHandler.bind(this)),this.$$stateMachineManager.push(a);this.setSymbolDuration(e.SYMBOL_DURATION),this.setGuardInterval(e.GUARD_INTERVAL),this.setSyncDuration(e.SYNC_DURATION),this.setSampleCollectionTimeIdleInitState(r.$$_SAMPLE_COLLECTION_TIME_IDLE_INIT_STATE),this.setSampleCollectionTimeFirstSyncState(r.$$_SAMPLE_COLLECTION_TIME_FIRST_SYNC_STATE),this.setSyncPreamble(e.SYNC_PREAMBLE),this.setPskSize(r.$$_ALL_CHANNEL,e.PSK_SIZE)},r.$$_SAMPLE_COLLECTION_TIME_IDLE_INIT_STATE=e.SYNC_DURATION,r.$$_SAMPLE_COLLECTION_TIME_FIRST_SYNC_STATE=.85*e.SYNC_DURATION,r.$$_TIME_TOLERANCE_SYMBOL_DURATION_FACTOR=2.2,r.$$_TIME_TOLERANCE_GUARD_INTERVAL_FACTOR=1.1,r.$$_TIME_TOLERANCE_SYNC_DURATION_FACTOR=1.1,r.$$_ALL_CHANNEL=null,r.prototype.reset=function(e){return this.$$checkChannelIndexRange(e),this.$$stateMachineManager[e].reset()},r.prototype.setSymbolDuration=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSymbolStateMaxDurationTime(e*r.$$_TIME_TOLERANCE_SYMBOL_DURATION_FACTOR)},r.prototype.setGuardInterval=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setGuardStateMaxDurationTime(e*r.$$_TIME_TOLERANCE_GUARD_INTERVAL_FACTOR)},r.prototype.setSyncDuration=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSyncStateMaxDurationTime(e*r.$$_TIME_TOLERANCE_SYNC_DURATION_FACTOR)},r.prototype.setSampleCollectionTimeIdleInitState=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSampleCollectionTimeIdleInitState(e)},r.prototype.setSampleCollectionTimeFirstSyncState=function(e){var t,i;for(t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSampleCollectionTimeFirstSyncState(e)},r.prototype.setSyncPreamble=function(e){var t,i;for(e=!!e,t=this.$$physicalLayer.getRxChannelSize(),i=0;i<t;i++)this.$$stateMachineManager[i].setSyncPreamble(e)},r.prototype.setPskSize=function(e,t){var i,n;if(e===r.$$_ALL_CHANNEL)for(i=this.$$physicalLayer.getRxChannelSize(),n=0;n<i;n++)this.$$stateMachineManager[n].setPskSize(t);else this.$$checkChannelIndexRange(e),this.$$stateMachineManager[e].setPskSize(t)},r.prototype.$$packetReceiveInternalHandler=function(e,t){var i;for(i=0;i<t.length;i++)1===t[i].length&&(t[i]=t[i][0]);this.$$packetReceiveHandler&&this.$$packetReceiveHandler(e,t)},r.prototype.$$frequencyUpdateInternalHandler=function(e,t){var r;null!==t&&(i.abs(t)>.005&&(r=this.$$physicalLayer.getRxFrequency(e,0),console.log("phase history current",r),this.$$physicalLayer.setRxFrequency(e,0,r+t),console.log("Frequency corrected for channel "+e+" at ofdm 0: "+(r+t))),this.$$frequencyUpdateHandler&&this.$$frequencyUpdateHandler(e,t))},r.prototype.$$phaseCorrectionUpdateInternalHandler=function(e,t){var i,r;for(r=0;r<t.length;r++)i=this.$$physicalLayer.getRxPhaseCorrection(e,r),this.$$physicalLayer.setRxPhaseCorrection(e,r,i+t[r].phase),console.log("Phase corrected for channel "+e+" at ofdm "+r+": "+(i+t[r].phase));this.$$phaseCorrectionUpdateHandler&&this.$$phaseCorrectionUpdateHandler(e,t)},r.prototype.$$checkChannelIndexRange=function(e){if(e<0||e>=this.$$physicalLayer.getRxChannelSize())throw"Given channelIndex is outside range: "+e},r.prototype.setPacketReceiveHandler=function(e){"function"==typeof e?this.$$packetReceiveHandler=e:this.$$packetReceiveHandler=null},r.prototype.setFrequencyUpdateHandler=function(e){"function"==typeof e?this.$$frequencyUpdateHandler=e:this.$$frequencyUpdateHandler=null},r.prototype.setPhaseCorrectionUpdateHandler=function(e){"function"==typeof e?this.$$phaseCorrectionUpdateHandler=e:this.$$phaseCorrectionUpdateHandler=null},r.prototype.receive=function(e,t,i){return this.$$checkChannelIndexRange(e),this.$$stateMachineManager[e].receive(t,i)},r}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.ReceiveAdapter",e),e.$inject=["PhysicalLayer.DefaultConfig","PhysicalLayerAdapter.RxStateMachineManagerBuilder","Common.MathUtil"]}(),function(){function e(e,t,i){var r;return r=function(e){this.$$physicalLayer=e},r.AMPLITUDE_DATA_LENGTH_DOES_NOT_MATCH_SYMBOL_LIST_LENGTH_EXCEPTION="Amplitude data length does not match symbol list length",r.$$_SYNCHRONIZATION_SYMBOL=0,r.$$_LOWEST_PSK_SIZE=1,r.$$_ZERO_GUARD_INTERVAL=0,r.$$_ZERO_INTERPACKET_GAP=0,r.$$_NO_SYNC_PREAMBLE=!1,r.$$_UNDEFINED_AMPLITUDE=void 0,r.prototype.symbol=function(e,n,o,a,s){var $,l=this.$$physicalLayer.getTxChannelOfdmSize(e),c=[];for($=0;$<l;$++)c.push($===n?o:null);c=[1===c.length?c[0]:c],this.packet(e,c,r.$$_NO_SYNC_PREAMBLE,a,t.valueOrDefault(s,i.SYMBOL_DURATION),r.$$_ZERO_GUARD_INTERVAL,r.$$_ZERO_INTERPACKET_GAP,r.$$_UNDEFINED_AMPLITUDE)},r.prototype.packet=function(n,o,a,s,$,l,c,h){var u,p,d=this.$$physicalLayer.getTxChannelOfdmSize(n);if(a=t.valueOrDefault(a,i.SYNC_PREAMBLE)){for(u=[],p=0;p<d;p++)u.push(r.$$_SYNCHRONIZATION_SYMBOL);u=1===u.length?u[0]:u,o.unshift(u)}if("undefined"==typeof h)for(h=[],p=0;p<d;p++)h.push(e.floor(1e3/d)/1e3);this.$$transmit(n,o,t.valueOrDefault(s,i.PSK_SIZE),t.valueOrDefault($,i.SYMBOL_DURATION),t.valueOrDefault(l,i.GUARD_INTERVAL),t.valueOrDefault(c,i.INTERPACKET_GAP),h)},r.prototype.synchronization=function(t){var n,o=this.$$physicalLayer.getTxChannelOfdmSize(t),a=[],s=[];for(n=0;n<o;n++)a.push(r.$$_SYNCHRONIZATION_SYMBOL),s.push(e.floor(1e3/o)/1e3);a=[1===a.length?a[0]:a],this.$$transmit(t,a,r.$$_LOWEST_PSK_SIZE,i.SYNC_DURATION,r.$$_ZERO_GUARD_INTERVAL,i.INTERPACKET_GAP,s)},r.prototype.$$transmit=function(e,t,i,n,o,a,s){var $,l,c,h,u,p,d,f=this.$$physicalLayer.getTxChannelOfdmSize(e);for(c=[],p=0;p<t.length;p++){if($=1===f&&"number"==typeof t[p]?[t[p]]:t[p],$.length!==s.length)throw r.AMPLITUDE_DATA_LENGTH_DOES_NOT_MATCH_SYMBOL_LIST_LENGTH_EXCEPTION;for(h=[],d=0;d<$.length;d++)u=null===$[d],l=u?0:parseInt($[d])%i,h.push({amplitude:u?0:s[d],duration:n,phase:l/i});if(c.push(h),o>0){for(h=[],d=0;d<$.length;d++)h.push({amplitude:0,duration:o});c.push(h)}}if(a>0&&$){for(h=[],d=0;d<$.length;d++)h.push({amplitude:0,duration:a});c.push(h)}for(p=0;p<c.length;p++)this.$$physicalLayer.tx(e,c[p])},r}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.TransmitAdapter",e),e.$inject=["Common.MathUtil","Common.Util","PhysicalLayer.DefaultConfig"]}(),function(){function e(e,t){var i;return i=function(i,r,n,o,a){e.call(this,i,r,n),this.$$colorAxis=t.valueOrDefault(o,"green"),this.$$colorCenteredCircle=t.valueOrDefault(a,"#DDD")},i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype.$$drawCenteredCircle=function(e){var t=this.$$canvasContext,i=.5*this.$$width,r=.5*this.$$height;t.strokeStyle=this.$$colorCenteredCircle,t.beginPath(),t.arc(i,r,e,0,2*Math.PI,!1),t.stroke()},i.prototype.$$drawAxis=function(){var e=this.$$canvasContext,t=this.$$width,i=this.$$height,r=.5*t,n=.5*i;e.strokeStyle=this.$$colorAxis,e.beginPath(),e.moveTo(0,n),e.lineTo(t,n),e.closePath(),e.stroke(),e.beginPath(),e.moveTo(r,0),e.lineTo(r,i),e.closePath(),e.stroke()},i.prototype.$$dropXYCache=function(){var e;for(e=0;e<this.$$queue.getSize();e++)delete this.$$queue.getItem(e).$$cache},i}AudioNetwork.Injector.registerFactory("Visualizer.Abstract2DVisualizer",e),e.$inject=["Visualizer.AbstractVisualizer","Common.Util"]}(),function(){function e(e){var t;return t=function(e,t,i){this.$$parentElement=e,this.$$width=t,this.$$height=i,this.$$canvasContext=null,this.$$destroyPromise=null,this.$$parentElement.innerHTML=this.$$renderTemplate(),this.$$initCanvas(),requestAnimationFrame(this.$$animationFrameHandler.bind(this))},t.ABSTRACT_METHOD_CALLED_EXCEPTION="Abstract method called!",t.prototype.destroy=function(){return this.$$destroyPromise?this.$$destroyPromise:(this.$$destroyPromise=e.build(),this.$$destroyPromise)},t.prototype.$$find=function(e){var t=this.$$parentElement.querySelectorAll(e);if(0===t.length)throw"Cannot $$find given selector";return t[0]},t.prototype.$$initCanvas=function(){var e=this.$$find("canvas");this.$$canvasContext=e.getContext("2d"),this.$$canvasContext.lineWidth=1},t.prototype.$$animationFrameHandler=function(){this.$$destroyPromise?(this.$$parentElement.innerHTML="",this.$$destroyPromise.resolve()):(this.$$canvasContext&&this.$$draw(),requestAnimationFrame(this.$$animationFrameHandler.bind(this)))},t.prototype.$$draw=function(){throw t.ABSTRACT_METHOD_CALLED_EXCEPTION},t.prototype.$$renderTemplate=function(){throw t.ABSTRACT_METHOD_CALLED_EXCEPTION},t}AudioNetwork.Injector.registerFactory("Visualizer.AbstractVisualizer",e),e.$inject=["Common.SimplePromiseBuilder"]}(),function(){function e(e){function t(t,i,r,n,o){return new e(t,i,r,n,o)}return{build:t}}AudioNetwork.Injector.registerService("Visualizer.AnalyserChartBuilder",e),e.$inject=["Visualizer.AnalyserChart"]}(),function(){function e(){var e='<span    style="        display: block;        box-sizing: border-box;        border-left: 1px solid {{ colorAxis }};        position: absolute;        width: {{ width }}px;        top: 0px;        left: {{ left }}px;        "    >    {{ label }}</span>';return{html:e}}AudioNetwork.Injector.registerService("Visualizer.AnalyserChartTemplateAxisX",e),e.$inject=[]}(),function(){function e(){var e='<div    class="analyser-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas        class="analyser-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas>    <div        class="analyser-action"        style="            position: absolute;        "        >        <a href="javascript:void(0)" class="analyser-action-fft256">FFT256</a>        <a href="javascript:void(0)" class="analyser-action-fft512">FFT512</a>        <a href="javascript:void(0)" class="analyser-action-fft1024">FFT1024</a>        <a href="javascript:void(0)" class="analyser-action-fft2048">FFT2048</a>        <a href="javascript:void(0)" class="analyser-action-fft4096">FFT4096</a>        <a href="javascript:void(0)" class="analyser-action-fft8192">FFT8192</a>        <a href="javascript:void(0)" class="analyser-action-fft16384">FFT16384</a>        <a href="javascript:void(0)" class="analyser-action-freq-timedomain">Freq/TimeDomain</a>        <a href="javascript:void(0)" class="analyser-action-freeze">Freeze</a>    </div>    <div         class="analyser-axis-x"         style="            position: absolute;            bottom: 0px;            left: 0px;            width: {{ width }}px;        "        ></div></div>';return{html:e}}AudioNetwork.Injector.registerService("Visualizer.AnalyserChartTemplateMain",e),e.$inject=[]}(),function(){function e(e,t,i,r,n){var o;return o=function(e,t,i,r,n){this.$$parentElement=e,this.$$analyser=t,this.$$canvas=null,this.$$canvasContext=null,this.$$canvasWidth=null,this.$$canvasHeight=i,this.$$colorData=r,this.$$colorAxis=n,this.$$data=null,this.$$freezeChart=!1,this.$$analyserMethod="getByteFrequencyData",this.$$destroyPromise=null,this.$$initAnimationFrame(),this.$$init()},o.$$_AXIS_LABEL_X_ONE_ITEM_WITH=40,o.prototype.destroy=function(){return this.$$destroyPromise?this.$$destroyPromise:(this.$$destroyPromise=i.build(),this.$$destroyPromise)},o.prototype.$$init=function(){this.$$canvasContext=null,this.$$parentElement.innerHTML=this.$$renderTemplate(),this.$$connectTemplate(),this.$$initCanvasContext()},o.prototype.$$find=function(e){var t=this.$$parentElement.querySelectorAll(e);if(0===t.length)throw"Cannot $$find given selector";return t[0]},o.prototype.$$connectTemplate=function(){var e=this;this.$$canvas=this.$$find(".analyser-chart"),this.$$canvasContext=this.$$canvas.getContext("2d"),this.$$canvasWidth=this.$$analyser.fftSize,this.$$find(".analyser-action-freq-timedomain").addEventListener("click",function(){e.actionFrequencyTimeDomainToggle()}),this.$$find(".analyser-action-freeze").addEventListener("click",function(){e.actionFreezeChart()}),this.$$find(".analyser-action-fft256").addEventListener("click",function(){e.actionChangeFFTSize(256)}),this.$$find(".analyser-action-fft512").addEventListener("click",function(){e.actionChangeFFTSize(512)}),this.$$find(".analyser-action-fft1024").addEventListener("click",function(){e.actionChangeFFTSize(1024)}),this.$$find(".analyser-action-fft2048").addEventListener("click",function(){e.actionChangeFFTSize(2048)}),this.$$find(".analyser-action-fft4096").addEventListener("click",function(){e.actionChangeFFTSize(4096)}),this.$$find(".analyser-action-fft8192").addEventListener("click",function(){e.actionChangeFFTSize(8192)}),this.$$find(".analyser-action-fft16384").addEventListener("click",function(){e.actionChangeFFTSize(16384)})},o.prototype.actionFrequencyTimeDomainToggle=function(){"getByteFrequencyData"===this.$$analyserMethod?this.$$analyserMethod="getByteTimeDomainData":this.$$analyserMethod="getByteFrequencyData",this.$$generateAxisX()},o.prototype.actionFreezeChart=function(){this.$$freezeChart=!this.$$freezeChart},o.prototype.actionChangeFFTSize=function(e){this.$$analyser.fftSize=e,this.$$init()},o.prototype.$$renderTemplate=function(){var e=t.html;return e=e.replace(/\{\{ width \}\}/g,this.$$analyser.frequencyBinCount.toString()),e=e.replace(/\{\{ height \}\}/g,this.$$canvasHeight.toString())},o.prototype.$$renderTemplateAxisXLabel=function(t,i,r){var n=e.html;return n=n.replace(/\{\{ width \}\}/g,t),n=n.replace(/\{\{ left \}\}/g,i),n=n.replace(/\{\{ label \}\}/g,r),n=n.replace(/\{\{ colorAxis \}\}/g,this.$$colorAxis)},o.prototype.$$generateAxisXForTimeDomain=function(){var e,t,i=[5e-4,.001,.002,.005,.01,.025,.05,.1,.25,.5],a=r.getSampleRate(),s=o.$$_AXIS_LABEL_X_ONE_ITEM_WITH/a,$=0,l="";for(t=0;t<i.length;t++)if(i[t]>=s||t==i.length-1){s=i[t];break}for(;$<this.$$analyser.frequencyBinCount/r.getSampleRate();)e=n.round($*a),l+=this.$$renderTemplateAxisXLabel(o.$$_AXIS_LABEL_X_ONE_ITEM_WITH,e,n.round(1e3*$)+"ms"),$+=s;return l},o.prototype.$$generateAxisXForFrequency=function(){var e,t,i=[50,100,125,200,250,500,1e3,2e3,2500,5e3,1e4,2e4],a=this.$$analyser.fftSize/r.getSampleRate(),s=o.$$_AXIS_LABEL_X_ONE_ITEM_WITH/a,$=0,l="";for(t=0;t<i.length;t++)if(i[t]>=s||t==i.length-1){s=i[t];break}for(;$<.5*r.getSampleRate();)e=n.round($*a),l+=this.$$renderTemplateAxisXLabel(o.$$_AXIS_LABEL_X_ONE_ITEM_WITH,e,$+"Hz"),$+=s;return l},o.prototype.$$generateAxisX=function(){var e=this.$$find(".analyser-axis-x");"getByteFrequencyData"==this.$$analyserMethod?e.innerHTML="<span>&nbsp;</span>"+this.$$generateAxisXForFrequency():e.innerHTML="<span>&nbsp;</span>"+this.$$generateAxisXForTimeDomain()},o.prototype.$$updateChart=function(){var e,t=this.$$data.length,i=this.$$canvasContext;if(null!==i&&!this.$$freezeChart)for(i.clearRect(0,0,this.$$canvasWidth,this.$$canvasHeight),this.$$analyser[this.$$analyserMethod](this.$$data),e=0;e<t;e++)i.beginPath(),i.moveTo(e,this.$$canvasHeight),i.lineTo(e,this.$$canvasHeight-n.round(this.$$canvasHeight*this.$$data[e]/255)),i.closePath(),i.stroke()},o.prototype.$$initCanvasContext=function(){this.$$data=new Uint8Array(this.$$analyser.frequencyBinCount),this.$$generateAxisX(),this.$$canvasContext.lineWidth=1,this.$$canvasContext.strokeStyle=this.$$colorData},o.prototype.$$initAnimationFrame=function(){function e(){t.$$destroyPromise?(t.$$parentElement.innerHTML="",t.$$destroyPromise.resolve()):(t.$$updateChart(),requestAnimationFrame(e))}var t=this;requestAnimationFrame(e)},o}AudioNetwork.Injector.registerFactory("Visualizer.AnalyserChart",e),e.$inject=["Visualizer.AnalyserChartTemplateAxisX","Visualizer.AnalyserChartTemplateMain","Common.SimplePromiseBuilder","Audio.ActiveAudioContext","Common.MathUtil"]}(),function(){function e(e){function t(t,i,r,n,o,a,s){return new e(t,i,r,n,o,a,s)}return{build:t}}AudioNetwork.Injector.registerService("Visualizer.ComplexPlaneChartBuilder",e),e.$inject=["Visualizer.ComplexPlaneChart"]}(),function(){function e(){var e='<div    class="complex-plane-chart-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="complex-plane-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>';return{html:e}}AudioNetwork.Injector.registerService("Visualizer.ComplexPlaneChartTemplateMain",e),e.$inject=[]}(),function(){function e(e,t,i){var r;return r=function(i,r,n,o,a,s,$){e.call(this,i,r,n,s,$),this.$$queue=o,this.$$maxValue=t.valueOrDefault(a,1),this.$$hashOnCanvas=null},r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.$$_VALUE_CIRCLE_STEP=1,r.prototype.setMaxValue=function(e){return this.$$maxValue!==e&&(this.$$maxValue=e,this.$$hashOnCanvas=null,this.$$dropXYCache(),!0)},r.prototype.$$renderTemplate=function(){var e=i.html;return e=e.replace(/\{\{ width \}\}/g,this.$$width.toString()),e=e.replace(/\{\{ height \}\}/g,this.$$height.toString())},r.prototype.$$draw=function(){var e,t,i,n,o,a,s,$=this.$$canvasContext,l=this.$$width,c=this.$$height,h=.5*l,u=.5*c,p=this.$$queue;if(this.$$hashOnCanvas!==p.getHash()){for($.clearRect(0,0,l,c),t=0;t<=this.$$maxValue;)i=u*this.$$getNormalizedValue(t),this.$$drawCenteredCircle(i),t+=r.$$_VALUE_CIRCLE_STEP;for(this.$$drawAxis(),s=$.lineWidth,a=0;a<p.getSize();a++)e=p.getItem(a),this.$$setItemXYCache(e),n=h+h*e.$$cache.x,o=u-u*e.$$cache.y,e.point&&($.fillStyle=e.pointColor,$.beginPath(),$.arc(n,o,e.pointRadius,0,2*Math.PI,!1),$.fill()),e.line&&($.lineWidth=e.lineWidth,$.strokeStyle=e.lineColor,$.beginPath(),$.moveTo(h,u),$.lineTo(n,o),$.closePath(),$.stroke());$.lineWidth=s,this.$$hashOnCanvas=p.getHash()}},r.prototype.$$setItemXYCache=function(e){e.$$cache||(e.$$cache={x:this.$$getNormalizedValue(e.real),y:this.$$getNormalizedValue(e.imm)})},r.prototype.$$getNormalizedValue=function(e){return e/this.$$maxValue},r}AudioNetwork.Injector.registerFactory("Visualizer.ComplexPlaneChart",e),e.$inject=["Visualizer.Abstract2DVisualizer","Common.Util","Visualizer.ComplexPlaneChartTemplateMain"]}(),function(){function e(e){function t(t,i,r,n,o,a,s,$,l,c){return new e(t,i,r,n,o,a,s,$,l,c)}return{build:t}}AudioNetwork.Injector.registerService("Visualizer.ConstellationDiagramBuilder",e),e.$inject=["Visualizer.ConstellationDiagram"]}(),function(){function e(){var e='<div    class="constellation-diagram-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="constellation-diagram"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>';return{html:e}}AudioNetwork.Injector.registerService("Visualizer.ConstellationDiagramTemplateMain",e),e.$inject=[]}(),function(){function e(e,t,i,r){var n;return n=function(t,r,n,o,a,s,$,l,c,h){e.call(this,t,r,n,s,l),this.$$queue=o,this.$$colorHistoryPoint=i.valueOrDefault($,{red:{newest:0,tailNewest:100,tailOldest:180},green:{newest:0,tailNewest:100,tailOldest:200},blue:{newest:0,tailNewest:100,tailOldest:150}}),this.$$radius=i.valueOrDefault(c,2),this.$$radiusMain=i.valueOrDefault(h,3),this.$$powerDecibelMin=i.valueOrDefault(a,-40),this.$$hashOnCanvas=null},n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.$$_POWER_DECIBEL_AXIS_LINE_STEP=10,n.prototype.setPowerDecibelMin=function(e){return this.$$powerDecibelMin!==e&&(this.$$powerDecibelMin=e,this.$$hashOnCanvas=null,this.$$dropXYCache(),!0)},n.prototype.$$renderTemplate=function(){var e=r.html;return e=e.replace(/\{\{ width \}\}/g,this.$$width.toString()),e=e.replace(/\{\{ height \}\}/g,this.$$height.toString())},n.prototype.$$draw=function(){var e,t,i,r,o,a,s,$,l,c=this.$$colorHistoryPoint,h=this.$$canvasContext,u=this.$$width,p=this.$$height,d=.5*u,f=.5*p,m=this.$$queue;if(this.$$hashOnCanvas!==m.getHash()){for(h.clearRect(0,0,u,p),t=0;t>=this.$$powerDecibelMin;)o=f*this.$$getNormalizedPowerDecibel(t),this.$$drawCenteredCircle(o),t-=n.$$_POWER_DECIBEL_AXIS_LINE_STEP;for(this.$$drawAxis(),$=0;$<m.getSize();$++)e=m.getItem($),this.$$setItemXYCache(e),a=d+d*e.$$cache.x,s=f-f*e.$$cache.y,i=1-$/(m.getSize()-2),
l=$===m.getSize()-1,r=l?"rgba("+c.red.newest+", "+c.green.newest+", "+c.blue.newest+", 1)":"rgba("+this.$$colorInterpolate(c.red.tailNewest,c.red.tailOldest,i)+", "+this.$$colorInterpolate(c.green.tailNewest,c.green.tailOldest,i)+", "+this.$$colorInterpolate(c.blue.tailNewest,c.blue.tailOldest,i)+", 1)",h.fillStyle=r,h.beginPath(),h.arc(a,s,l?this.$$radiusMain:this.$$radius,0,2*Math.PI,!1),h.fill();this.$$hashOnCanvas=m.getHash()}},n.prototype.$$getNormalizedPowerDecibel=function(e){var t;return t=e/this.$$powerDecibelMin,t=1-t,t=t<0?null:t},n.prototype.$$setItemXYCache=function(e){var i;e.$$cache||(i=this.$$getNormalizedPowerDecibel(e.powerDecibel),e.$$cache={x:null===i?0:i*t.sin(t.TWO_PI*e.phase),y:null===i?0:i*t.cos(t.TWO_PI*e.phase),outOfRange:null===i})},n.prototype.$$colorInterpolate=function(e,i,r){return t.round(e+(i-e)*r)},n}AudioNetwork.Injector.registerFactory("Visualizer.ConstellationDiagram",e),e.$inject=["Visualizer.Abstract2DVisualizer","Common.MathUtil","Common.Util","Visualizer.ConstellationDiagramTemplateMain"]}(),function(){function e(e){function t(t,i,r,n,o,a,s,$,l,c){return new e(t,i,r,n,o,a,s,$,l,c)}return{build:t}}AudioNetwork.Injector.registerService("Visualizer.FrequencyDomainChartBuilder",e),e.$inject=["Visualizer.FrequencyDomainChart"]}(),function(){function e(){var e='<div    class="frequency-domain-chart-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="frequency-domain-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>';return{html:e}}AudioNetwork.Injector.registerService("Visualizer.FrequencyDomainChartTemplateMain",e),e.$inject=[]}(),function(){function e(e,t,i){var r;return r=function(t,r,n,o,a,s,$,l,c,h){e.call(this,t,r,n),this.$$frequencyDomainQueue=o,this.$$powerDecibelMin=i.valueOrDefault(a,-40),this.$$radius=i.valueOrDefault(s,1.1),this.$$barWidth=i.valueOrDefault($,1),this.$$barSpacingWidth=i.valueOrDefault(l,0),this.$$colorAxis=i.valueOrDefault(c,"#EEE"),this.$$colorSample=i.valueOrDefault(h,"#738BD7"),this.$$checkWidth(),this.$$hashOnCanvas=null},r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.QUEUE_SIZE_NOT_MATCH_CHART_WIDTH="Queue size not match chart width",r.$$_POWER_DECIBEL_AXIS_LINE_STEP=10,r.prototype.setWidth=function(e){var t;return this.$$width!==e&&(this.$$width=e,this.$$checkWidth(),t=this.$$find(".frequency-domain-chart-container"),t.style.width=e+"px",t=this.$$find(".frequency-domain-chart"),t.style.width=e+"px",t.setAttribute("width",e),this.$$hashOnCanvas=null,!0)},r.prototype.$$checkWidth=function(){if(this.$$frequencyDomainQueue.getSizeMax()*(this.$$barWidth+this.$$barSpacingWidth)!==this.$$width)throw r.QUEUE_SIZE_NOT_MATCH_CHART_WIDTH},r.prototype.$$renderTemplate=function(){var e=t.html;return e=e.replace(/\{\{ width \}\}/g,this.$$width.toString()),e=e.replace(/\{\{ height \}\}/g,this.$$height.toString())},r.prototype.setPowerDecibelMin=function(e){return this.$$powerDecibelMin!==e&&(this.$$powerDecibelMin=e,this.$$hashOnCanvas=null,!0)},r.prototype.$$draw=function(){var e,t,i,n,o,a=this.$$canvasContext,s=this.$$frequencyDomainQueue,$=this.$$width,l=this.$$height;if(this.$$hashOnCanvas!==s.getHash()){for(a.clearRect(0,0,$,l),a.strokeStyle=this.$$colorAxis,t=0;t<=-this.$$powerDecibelMin;t+=r.$$_POWER_DECIBEL_AXIS_LINE_STEP)n=t*l/-this.$$powerDecibelMin,a.beginPath(),a.moveTo(0,n),a.lineTo($,n),a.closePath(),a.stroke();for(a.fillStyle=this.$$colorSample,o=.5*(this.$$barWidth-1),t=0;t<s.getSize();t++)e=s.getItem(t),i=t*(this.$$barWidth+this.$$barSpacingWidth),n=e/this.$$powerDecibelMin*l,this.$$barSpacingWidth>=1&&(a.beginPath(),a.moveTo(i,0),a.lineTo(i,l),a.closePath(),a.stroke()),n>=l||(a.beginPath(),a.arc(i+this.$$barSpacingWidth+o,n,this.$$radius,0,2*Math.PI,!1),a.fill());this.$$hashOnCanvas=s.getHash()}},r.prototype.$$initCanvasContext=function(){this.$$canvasContext.lineWidth=1},r}AudioNetwork.Injector.registerFactory("Visualizer.FrequencyDomainChart",e),e.$inject=["Visualizer.AbstractVisualizer","Visualizer.FrequencyDomainChartTemplateMain","Common.Util"]}(),function(){function e(e){function t(t,i,r,n,o,a,s,$,l,c){return new e(t,i,r,n,o,a,s,$,l,c)}return{build:t}}AudioNetwork.Injector.registerService("Visualizer.SampleChartBuilder",e),e.$inject=["Visualizer.SampleChart"]}(),function(){function e(){var e='<div    class="sample-chart-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="sample-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>';return{html:e}}AudioNetwork.Injector.registerService("Visualizer.SampleChartTemplateMain",e),e.$inject=[]}(),function(){function e(e,t,i){var r;return r=function(t,r,n,o,a,s,$,l,c,h){e.call(this,t,r,n),this.$$queue=o,this.$$radius=i.valueOrDefault(a,1.1),this.$$barWidth=i.valueOrDefault(s,1),this.$$barSpacingWidth=i.valueOrDefault($,0),this.$$colorAxis=i.valueOrDefault(l,"#EEE"),this.$$colorSample=i.valueOrDefault(c,"rgba(115, 139, 215, 1.0"),this.$$colorBar=i.valueOrDefault(h,"rgba(115, 139, 215, 0.9)"),this.$$sampleBackgroundActive=!1,this.$$checkWidth(),this.$$hashOnCanvas=null},r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.QUEUE_SIZE_NOT_MATCH_CHART_WIDTH="Queue size not match chart width",r.prototype.setWidth=function(e){var t;return this.$$width!==e&&(this.$$width=e,this.$$checkWidth(),t=this.$$find(".sample-chart-container"),t.style.width=e+"px",t=this.$$find(".sample-chart"),t.style.width=e+"px",t.setAttribute("width",e),this.$$hashOnCanvas=null,!0)},r.prototype.enableSampleBackground=function(){return!this.$$sampleBackgroundActive&&(this.$$sampleBackgroundActive=!0,this.$$hashOnCanvas=null,!0)},r.prototype.$$checkWidth=function(){if(this.$$queue.getSizeMax()*(this.$$barWidth+this.$$barSpacingWidth)!==this.$$width)throw r.QUEUE_SIZE_NOT_MATCH_CHART_WIDTH},r.prototype.$$renderTemplate=function(){var e=t.html;return e=e.replace(/\{\{ width \}\}/g,this.$$width.toString()),e=e.replace(/\{\{ height \}\}/g,this.$$height.toString())},r.prototype.$$draw=function(){var e,t,i,r,n,o=this.$$canvasContext,a=this.$$queue,s=this.$$width,$=this.$$height,l=.5*this.$$height;if(this.$$hashOnCanvas!==a.getHash()){for(o.clearRect(0,0,s,$),o.strokeStyle=this.$$colorAxis,o.beginPath(),o.moveTo(0,l),o.lineTo(s,l),o.closePath(),o.stroke(),n=.5*(this.$$barWidth-1),t=0;t<a.getSize();t++)e=a.getItem(t),i=t*(this.$$barWidth+this.$$barSpacingWidth),r=(.5-.5*e)*$,this.$$barSpacingWidth>0&&(1===this.$$barSpacingWidth?(o.strokeStyle=this.$$colorAxis,o.beginPath(),o.moveTo(i,0),o.lineTo(i,$),o.closePath(),o.stroke()):(o.fillStyle=this.$$colorAxis,o.fillRect(i,0,this.$$barSpacingWidth,$))),this.$$sampleBackgroundActive&&(1===this.$$barWidth?(o.strokeStyle=this.$$colorBar,o.beginPath(),o.moveTo(i+this.$$barSpacingWidth,l),o.lineTo(i+this.$$barSpacingWidth,r),o.closePath(),o.stroke()):(o.fillStyle=this.$$colorBar,o.fillRect(i+this.$$barSpacingWidth,l<r?l:r,this.$$barWidth,l<r?r-l:l-r))),o.fillStyle=this.$$colorSample,o.beginPath(),o.arc(i+this.$$barSpacingWidth+n,r,this.$$radius,0,2*Math.PI,!1),o.fill();this.$$hashOnCanvas=a.getHash()}},r.prototype.$$initCanvasContext=function(){this.$$canvasContext.lineWidth=1},r}AudioNetwork.Injector.registerFactory("Visualizer.SampleChart",e),e.$inject=["Visualizer.AbstractVisualizer","Visualizer.SampleChartTemplateMain","Common.Util"]}(),function(){function e(e){function t(t,i,r){return new e(t,i,r)}return{build:t}}AudioNetwork.Injector.registerService("Visualizer.PowerChartBuilder",e),e.$inject=["Visualizer.PowerChart"]}(),function(){function e(){var e='<div    class="power-chart-container"    style="        overflow: hidden;        width: {{ width }}px;        height: {{ height }}px;        position: relative;    "    >    <canvas         class="power-chart"        style="            width: {{ width }}px;            height: {{ height }}px;            position: absolute;        "        width="{{ width }}"        height="{{ height }}"        ></canvas></div>';return{html:e}}AudioNetwork.Injector.registerService("Visualizer.PowerChartTemplateMain",e),e.$inject=[]}(),function(){function e(e,t){var i;return i=function(e,t,i,r){this.$$parentElement=e,this.$$canvas=null,this.$$canvasContext=null,this.$$canvasWidth=t,this.$$canvasHeight=i,this.$$queue=r,this.$$destroyPromise=null,this.$$initAnimationFrame(),this.$$init()},i.prototype.destroy=function(){return this.$$destroyPromise?this.$$destroyPromise:(this.$$destroyPromise=t.build(),this.$$destroyPromise)},i.prototype.$$init=function(){this.$$canvasContext=null,this.$$parentElement.innerHTML=this.$$renderTemplate(),this.$$connectTemplate(),this.$$initCanvasContext()},i.prototype.$$find=function(e){var t=this.$$parentElement.querySelectorAll(e);if(0===t.length)throw"Cannot $$find given selector";return t[0]},i.prototype.$$connectTemplate=function(){this.$$canvas=this.$$find(".power-chart"),this.$$canvasContext=this.$$canvas.getContext("2d")},i.prototype.$$renderTemplate=function(){var t=e.html;return t=t.replace(/\{\{ width \}\}/g,this.$$canvasWidth.toString()),t=t.replace(/\{\{ height \}\}/g,this.$$canvasHeight.toString())},i.prototype.$$updateChart=function(){var e,t,i,r,n=this.$$canvasContext,o=this.$$queue,a=this.$$canvasWidth,s=this.$$canvasHeight;if(null!==n){for(n.clearRect(0,0,a,s),r=0;r<s;r+=10)n.strokeStyle="#EEE",n.beginPath(),n.moveTo(0,2*r),n.lineTo(a,2*r),n.closePath(),n.stroke();for(t=0;t<o.getSize();t++)e=o.getItem(t),i=t,r=-e,n.fillStyle="#738BD7",n.fillRect(i-1,2*r-1,3,3)}},i.prototype.$$initCanvasContext=function(){this.$$canvasContext.lineWidth=1},i.prototype.$$initAnimationFrame=function(){function e(){t.$$destroyPromise?(t.$$parentElement.innerHTML="",t.$$destroyPromise.resolve()):(t.$$updateChart(),requestAnimationFrame(e))}var t=this;requestAnimationFrame(e)},i}AudioNetwork.Injector.registerFactory("Visualizer.PowerChart",e),e.$inject=["Visualizer.PowerChartTemplateMain","Common.SimplePromiseBuilder"]}(),function(){function e(e){function t(){u=e.build()}function i(){null===u&&t()}function r(e){return i(),u.loadRecordedAudio(e)}function n(){return i(),u.getMicrophoneNode()}function o(){return i(),u.getRecordedAudioNode()}function a(){return i(),u.getSampleRate()}function s(){return i(),u.getDestination()}function $(){return i(),u.getCurrentTime()}function l(){return i(),u.createAnalyser()}function c(){return i(),u.createGain()}function h(){return i(),u.createScriptProcessor()}var u=null;return{loadRecordedAudio:r,getMicrophoneNode:n,getRecordedAudioNode:o,getSampleRate:a,getDestination:s,getCurrentTime:$,createAnalyser:l,createGain:c,createScriptProcessor:h}}AudioNetwork.Injector.registerService("Audio.ActiveAudioContext",e),e.$inject=["Audio.SimpleAudioContextBuilder"]}(),function(){function e(e){function t(){return new e}return{build:t}}AudioNetwork.Injector.registerService("Audio.SimpleAudioContextBuilder",e),e.$inject=["Audio.SimpleAudioContext"]}(),function(){function e(e){var t;return t=function(){this.$$context=null,this.$$rawMicrophoneNode=null,this.$$microphoneNode=null,this.$$recordedNode=null,this.$$recordedRawNode=null,this.$$init()},t.prototype.getCurrentTime=function(){return this.$$context.currentTime},t.prototype.createAnalyser=function(){return this.$$context.createAnalyser()},t.prototype.createGain=function(){return this.$$context.createGain()},t.prototype.createScriptProcessor=function(e,t,i){return this.$$context.createScriptProcessor(e,t,i)},t.prototype.getSampleRate=function(){return this.$$context.sampleRate},t.prototype.getDestination=function(){return this.$$context.destination},t.prototype.getMicrophoneNode=function(){return this.$$microphoneNode},t.prototype.getRecordedAudioNode=function(){return this.$$recordedNode},t.prototype.loadRecordedAudio=function(t){var i=this,r=new XMLHttpRequest,n=e.build();return r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){i.$$context.decodeAudioData(r.response,function(e){i.$$recordedRawNode&&i.$$recordedRawNode.disconnect(i.$$recordedNode),i.$$recordedRawNode=i.$$context.createBufferSource(),i.$$recordedRawNode.buffer=e,i.$$recordedRawNode.connect(i.$$recordedNode),i.$$recordedRawNode.loop=!0,i.$$recordedRawNode.start(0),n.resolve()},function(e){n.reject(e)})},r.send(),n},t.prototype.$$getConstraints=function(){return{video:!1,audio:{mandatory:{googEchoCancellation:!1,googAutoGainControl:!1,googNoiseSuppression:!1,googHighpassFilter:!1},optional:[]}}},t.prototype.$$normalizeGlobalVariable=function(){window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia},t.prototype.$$init=function(){var e=this;this.$$normalizeGlobalVariable();try{this.$$context=new window.AudioContext}catch(t){alert("Web Audio API is not supported in this browser"),console.log(t)}this.$$microphoneNode=this.$$context.createGain(),this.$$recordedNode=this.$$context.createGain();try{navigator.getUserMedia(this.$$getConstraints(),function(t){e.$$rawMicrophoneNode=e.$$context.createMediaStreamSource(t),e.$$rawMicrophoneNode.connect(e.$$microphoneNode)},function(e){alert("Microphone initialization failed"),console.log(e)})}catch(t){alert("Microphone initialization failed"),console.log(t)}},t}AudioNetwork.Injector.registerFactory("Audio.SimpleAudioContext",e),e.$inject=["Common.SimplePromiseBuilder"]}(),function(){function e(){var e;return e=function(){this.$$valueList=[],this.$$lastFinalizedSize=void 0,this.$$lastFinalizedResult=void 0},e.ABSTRACT_METHOD_CALLED_EXCEPTION="Abstract method called!",e.prototype.collect=function(e){this.$$valueList.push(e)},e.prototype.hasAtLeastItem=function(){return this.getSize()>0},e.prototype.getSize=function(){return this.$$valueList.length},e.prototype.clearAll=function(){this.clearList(),this.$$lastFinalizedSize=void 0,this.$$lastFinalizedResult=void 0},e.prototype.clearList=function(){this.$$valueList.length=0},e.prototype.finalize=function(){return this.$$lastFinalizedResult=this.$$finalize(),this.$$lastFinalizedSize=this.getSize(),this.clearList(),this.$$lastFinalizedResult},e.prototype.getLastFinalizedSize=function(){return this.$$lastFinalizedSize},e.prototype.getLastFinalizedResult=function(){return this.$$lastFinalizedResult},e.prototype.$$finalize=function(){throw e.ABSTRACT_METHOD_CALLED_EXCEPTION},e}AudioNetwork.Injector.registerFactory("Common.AbstractValueCollector",e),e.$inject=[]}(),function(){function e(e){function t(){return new e}return{build:t}}AudioNetwork.Injector.registerService("Common.AverageValueCollectorBuilder",e),e.$inject=["Common.AverageValueCollector"]}(),function(){function e(e,t){var i;return i=function(){e.apply(this,arguments)},i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.EMPTY_LIST_EXCEPTION="Cannot finalize AverageValueCollector without any samples collected",i.prototype.$$finalize=function(){if(0===this.$$valueList.length)throw i.EMPTY_LIST_EXCEPTION;return t.computeAverage(this.$$valueList)},i}AudioNetwork.Injector.registerFactory("Common.AverageValueCollector",e),e.$inject=["Common.AbstractValueCollector","Common.Util"]}(),function(){function e(e){function t(t){return new e(t)}return{build:t}}AudioNetwork.Injector.registerService("Common.CarrierGenerateBuilder",e),e.$inject=["Common.CarrierGenerate"]}(),function(){function e(e,t){var i;return i=function(e,t){this.$$samplePerFade=t,this.$$queue=[],this.$$sampleComputed=null,this.$$currentCarrier={data:null,sampleNumberStart:null,sampleNumberEnd:null},this.$$samplePerPeriod=null,this.$$omega=null,this.$$sampleNumber=0,this.$$phaseCorrection=0,this.setSamplePerPeriod(e)},i.prototype.$$sampleCompute=function(){var i,r,n,o=this.$$currentCarrier.data;return o?(i=1,this.$$samplePerFade>0&&(r=(this.$$sampleNumber-this.$$currentCarrier.sampleNumberStart)/this.$$samplePerFade,n=(this.$$currentCarrier.sampleNumberEnd-this.$$sampleNumber)/this.$$samplePerFade,r>=0&&r<=1?i=t.unitFade(r):n>=0&&n<=1&&(i=t.unitFade(n))),void(this.$$sampleComputed=i*o.amplitude*e.sin(this.$$omega*this.$$sampleNumber-e.TWO_PI*(o.phase-this.$$phaseCorrection)))):void(this.$$sampleComputed=0)},i.prototype.$$grabCurrentCarrier=function(){var e,i;e=t.queuePop(this.$$queue),e?(i=e===this.$$currentCarrier.data,i||(this.$$currentCarrier.data=e,this.$$currentCarrier.sampleNumberStart=this.$$sampleNumber,this.$$currentCarrier.sampleNumberEnd=this.$$currentCarrier.sampleNumberStart+e.duration)):(this.$$currentCarrier.data=null,this.$$currentCarrier.sampleNumberStart=null,this.$$currentCarrier.sampleNumberEnd=null)},i.prototype.setPhaseCorrection=function(e){this.$$phaseCorrection=e},i.prototype.nextSample=function(){this.$$sampleNumber++,this.$$sampleComputed=null},i.prototype.getSample=function(){return this.$$sampleComputed?this.$$sampleComputed:(this.$$grabCurrentCarrier(),this.$$sampleCompute(),this.$$sampleComputed)},i.prototype.addToQueue=function(e){t.queueAdd(this.$$queue,e,function(e,t){e.amplitude=t.amplitude,e.phase=t.phase})},i.prototype.reset=function(){this.$$sampleNumber=0},i.prototype.setSamplePerPeriod=function(t){return t!==this.$$samplePerPeriod&&(this.$$samplePerPeriod=t,this.$$omega=e.TWO_PI/this.$$samplePerPeriod,this.$$sampleNumber=0,!0)},i}AudioNetwork.Injector.registerFactory("Common.CarrierGenerate",e),e.$inject=["Common.MathUtil","Common.Util"]}(),function(){function e(e){function t(t,i){return new e(t,i)}return{build:t}}AudioNetwork.Injector.registerService("Common.CarrierRecoveryBuilder",e),e.$inject=["Common.CarrierRecovery"]}(),function(){function e(e,t,i,r){var n;return n=function(e,t){this.$$samplePerDftWindow=void 0,this.$$complexQueue=void 0,this.$$complexQueueSum=void 0,this.setSamplePerDftWindow(t),this.$$samplePerPeriod=void 0,this.$$omega=void 0,this.$$sampleNumber=void 0,this.setSamplePerPeriod(e)},n.prototype.$$getUnitComplex=function(){var e=this.$$omega*this.$$sampleNumber;return r.build(-t.cos(e),t.sin(e))},n.prototype.handleSample=function(e){var t,i;this.$$complexQueue.isFull()&&(t=this.$$complexQueue.pop(),this.$$complexQueueSum.sub(t)),i=this.$$getUnitComplex(),i.mulScalar(e),this.$$complexQueue.push(i),this.$$complexQueueSum.add(i),this.$$sampleNumber++},n.prototype.getCarrierDetail=function(){var e=r.copy(this.$$complexQueueSum);return e.divScalar(this.$$complexQueue.getSize()),{phase:e.findUnitAngle(),powerDecibel:i.convertToDecibel(e.getAbsoluteValue())}},n.prototype.setSamplePerDftWindow=function(t){return t!==this.$$samplePerDftWindow&&(this.$$samplePerDftWindow=t,this.$$complexQueue=e.build(t),this.$$complexQueueSum=r.build(0,0),!0)},n.prototype.setSamplePerPeriod=function(e){return e!==this.$$samplePerPeriod&&(this.$$samplePerPeriod=e,this.$$omega=t.TWO_PI/this.$$samplePerPeriod,this.$$sampleNumber=0,!0)},n}AudioNetwork.Injector.registerFactory("Common.CarrierRecovery",e),e.$inject=["Common.QueueBuilder","Common.MathUtil","Common.Util","Common.ComplexBuilder"]}(),function(){function e(e){function t(t,i){return new e(t,i)}function i(t){return new e(t.real,t.imm)}return{build:t,copy:i}}AudioNetwork.Injector.registerService("Common.ComplexBuilder",e),e.$inject=["Common.Complex"]}(),function(){function e(e,t){var i;return i=function(e,t){this.real=e,this.imm=t},i.prototype.add=function(e){this.real+=e.real,this.imm+=e.imm},i.prototype.sub=function(e){this.real-=e.real,this.imm-=e.imm},i.prototype.mulScalar=function(e){this.real*=e,this.imm*=e},i.prototype.divScalar=function(e){this.real/=e,this.imm/=e},i.prototype.getAbsoluteValue=function(){return t.sqrt(this.real*this.real+this.imm*this.imm)},i.prototype.findUnitAngle=function(){return e.findUnitAngle(this.real,this.imm)},i}AudioNetwork.Injector.registerFactory("Common.Complex",e),e.$inject=["Common.Util","Common.MathUtil"]}(),function(){function e(e){function t(t){return new e(t)}return{build:t}}AudioNetwork.Injector.registerService("Common.QueueBuilder",e),e.$inject=["Common.Queue"]}(),function(){function e(e){var t;return t=function(e){this.$$data=[],this.$$positionStart=null,this.$$positionEnd=null,this.$$size=null,this.$$hash=null,this.$$sizeMax=null,this.setSizeMax(e)},t.prototype.$$generateNewHash=function(){this.$$hash=1e6*e.random()},t.prototype.setSizeMax=function(e){this.$$positionStart=0,this.$$positionEnd=0,this.$$size=0,this.$$hash=0,this.$$sizeMax=e,this.$$data.length=0,this.$$data.length=e},t.prototype.getHash=function(){return this.$$hash},t.prototype.push=function(e){return this.$$size!==this.$$sizeMax&&(this.$$data[this.$$positionEnd]=e,this.$$positionEnd=(this.$$positionEnd+1)%this.$$sizeMax,this.$$size++,this.$$generateNewHash(),!0)},t.prototype.pushEvenIfFull=function(e){this.isFull()&&this.pop(),this.push(e)},t.prototype.pop=function(){var e;return 0===this.$$size?null:(e=this.$$data[this.$$positionStart],this.$$positionStart=(this.$$positionStart+1)%this.$$sizeMax,this.$$size--,this.$$generateNewHash(),e)},t.prototype.getItem=function(e){return e>=this.$$size?null:this.$$data[(this.$$positionStart+e)%this.$$sizeMax]},t.prototype.getSize=function(){return this.$$size},t.prototype.getSizeMax=function(){return this.$$sizeMax},t.prototype.isFull=function(){return this.$$size===this.$$sizeMax},t}AudioNetwork.Injector.registerFactory("Common.Queue",e),e.$inject=["Common.MathUtil"]}(),function(){function e(e){function t(e,t){return"undefined"!=typeof e?e:t}function i(e,t){var i,r=t.split("."),n=e;if(e){for(i=0;i<r.length&&(n=n[r[i]],n);i++);return n}}function r(e){var t,i;if(!e||0===e.length)return 0;for(i=0,t=0;t<e.length;t++)i+=e[t];return i/e.length}function n(t){return 10*e.log(t)/e.LN10}function o(t,i){var r,n,o;switch(r=e.sqrt(t*t+i*i),r=r<1e-6?1e-6:r,n=t>=0?i>=0?0:1:i<0?2:3){case 0:o=e.asin(t/r);break;case 1:o=e.asin(-i/r)+e.HALF_PI;break;case 2:o=e.asin(-t/r)+e.PI;break;case 3:o=e.asin(i/r)+1.5*e.PI}return o/e.TWO_PI}function a(t){return t=t<0?0:t,t=t>1?1:t,.5*(e.sin((t-.5)*e.PI)+1)}function s(e,t,i,r){var n;r=void 0===r?"duration":r,t[r]>0&&(n={},n[r]=t[r],i(n,t),e.push(n))}function $(e,t){var i;return t=void 0===t?"duration":t,0===e.length?null:(e[0][t]--,i=e[0],0===e[0][t]&&e.splice(0,1),i)}function l(e,t){var r,n,o=null,a=null;if(!e)return null;for(r=0;r<e.length;r++)n=i(e[r],t),(null===a||n>o)&&(o=n,a=r);return a}return{valueOrDefault:t,accessor:i,computeAverage:r,convertToDecibel:n,findUnitAngle:o,unitFade:a,queueAdd:s,queuePop:$,findMaxValueIndex:l}}AudioNetwork.Injector.registerService("Common.Util",e),e.$inject=["Common.MathUtil"]}(),function(){function e(e){var t;return t=function(){this.$$cpuLoadData={blockSampleSize:null,blockTime:null,blockRealTime:null,load:null}},t.prototype.getCpuLoadData=function(){var e=this.$$cpuLoadData;return{blockSampleSize:e.blockSampleSize,blockTime:e.blockTime,blockRealTime:e.blockRealTime,load:e.load}},t.prototype.$$computeCpuLoadData=function(t,i,r){var n,o,a=this.$$cpuLoadData;n=i-t,o=r/e.getSampleRate(),a.blockSampleSize=r,a.blockTime=o,a.blockRealTime=n,a.load=n/o},t}AudioNetwork.Injector.registerFactory("PhysicalLayer.AbstractChannelManager",e),e.$inject=["Audio.ActiveAudioContext"]}(),function(){function e(e){function t(t,i){return new e(t,i)}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayer.ChannelReceiveBuilder",e),e.$inject=["PhysicalLayer.ChannelReceive"]}(),function(){function e(e,t,i){var r;return r=function(e,t){this.$$carrierRecovery=[],this.$$carrierFrequency=[],this.$$carrierPhaseCorrection=[],this.$$notifyInterval=null,this.$$notifyHandler=null,this.$$index=e,this.configure(t)},r.OFDM_INDEX_OUT_OF_RANGE_EXCEPTION="OFDM index out of range: ",r.prototype.configure=function(i){var r,n,o,a;for(r=0;r<i.ofdmSize;r++)a=i.baseFrequency+r*i.ofdmFrequencySpacing,o=e.getSampleRate()/a,n=t.build(o,i.dftWindowSize),this.$$carrierRecovery.push(n),this.$$carrierFrequency.push(a),this.$$carrierPhaseCorrection.push(0);this.$$notifyInterval=i.notifyInterval,this.$$notifyHandler=i.notifyHandler},r.prototype.$$checkOfdmIndex=function(e){if(e<0||e>=this.$$carrierRecovery.length)throw r.OFDM_INDEX_OUT_OF_RANGE_EXCEPTION+e},r.prototype.getOfdmSize=function(){return this.$$carrierRecovery.length},r.prototype.getRxPhaseCorrection=function(e){return this.$$checkOfdmIndex(e),this.$$carrierPhaseCorrection[e]},r.prototype.getFrequency=function(e){return this.$$checkOfdmIndex(e),this.$$carrierFrequency[e]},r.prototype.setRxPhaseCorrection=function(e,t){this.$$checkOfdmIndex(e),this.$$carrierPhaseCorrection[e]=t-i.floor(t)},r.prototype.setFrequency=function(t,i){var r;this.$$checkOfdmIndex(t),r=e.getSampleRate()/i,this.$$carrierRecovery[t].setSamplePerPeriod(r),this.$$carrierFrequency[t]=i},r.prototype.handleSample=function(t,r,n,o){var a,s,$,l,c,h;for(a=r%this.$$notifyInterval===0,a&&(c=[]),l=0;l<this.$$carrierRecovery.length;l++)s=this.$$carrierRecovery[l],s.handleSample(t),a&&($=s.getCarrierDetail(),$.phase=$.phase-this.$$carrierPhaseCorrection[l],$.phase=$.phase-i.floor($.phase),c.push($));a&&(h=o/e.getSampleRate(),this.$$notifyHandler(this.$$index,c,n+h))},r.prototype.destroy=function(){this.$$carrierRecovery.length=0,this.$$carrierFrequency.length=0,this.$$carrierPhaseCorrection.length=0},r}AudioNetwork.Injector.registerFactory("PhysicalLayer.ChannelReceive",e),e.$inject=["Audio.ActiveAudioContext","Common.CarrierRecoveryBuilder","Common.MathUtil"]}(),function(){function e(e){function t(t,i){return new e(t,i)}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayer.ChannelReceiveManagerBuilder",e),e.$inject=["PhysicalLayer.ChannelReceiveManager"]}(),function(){function e(e,t,i){var r;return r=function(t,i){e.apply(this,arguments),this.$$channelReceive=[],this.$$scriptNode=null,this.$$analyserNode=null,this.$$configuration=t,this.$$bufferSize=i,this.$$sampleNumberGlobal=0,this.$$init()},r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.CHANNEL_INDEX_OUT_OF_RANGE_EXCEPTION="Channel index out of range: ",r.$$_LOWEST_FFT_SIZE=256,r.prototype.destroy=function(){var e,t;for(e=0;e<this.$$channelReceive.length;e++)t=this.$$channelReceive[e],t.destroy();this.$$channelReceive.length=0},r.prototype.getInputNode=function(){return this.$$scriptNode},r.prototype.getChannelSize=function(){return this.$$channelReceive.length},r.prototype.getChannel=function(e){if(e<0||e>=this.$$channelReceive.length)throw r.CHANNEL_INDEX_OUT_OF_RANGE_EXCEPTION+e;return this.$$channelReceive[e]},r.prototype.getBufferSize=function(){return this.$$scriptNode.bufferSize},r.prototype.$$init=function(){var e,n;for(this.$$scriptNode=t.createScriptProcessor(this.$$bufferSize,1,1),this.$$scriptNode.onaudioprocess=this.onAudioProcess.bind(this),this.$$analyserNode=t.createAnalyser(),this.$$analyserNode.fftSize=r.$$_LOWEST_FFT_SIZE,this.$$scriptNode.connect(this.$$analyserNode),e=0;e<this.$$configuration.length;e++)n=i.build(e,this.$$configuration[e]),this.$$channelReceive.push(n)},r.prototype.onAudioProcess=function(e){var i,r,n,o=e.inputBuffer,a=o.getChannelData(0),s=t.getCurrentTime();for(r=0;r<o.length;r++){for(i=a[r],n=0;n<this.$$channelReceive.length;n++)this.$$channelReceive[n].handleSample(i,this.$$sampleNumberGlobal,s,r);this.$$sampleNumberGlobal++}this.$$computeCpuLoadData(s,t.getCurrentTime(),o.length)},r}AudioNetwork.Injector.registerFactory("PhysicalLayer.ChannelReceiveManager",e),e.$inject=["PhysicalLayer.AbstractChannelManager","Audio.ActiveAudioContext","PhysicalLayer.ChannelReceiveBuilder"]}(),function(){function e(e){function t(t,i){return new e(t,i)}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayer.ChannelTransmitManagerBuilder",e),e.$inject=["PhysicalLayer.ChannelTransmitManager"]}(),function(){function e(e,t,i,r,n){var o;return o=function(t,i){e.apply(this,arguments),this.$$channelTransmit=[],this.$$scriptNode=null,this.$$configuration=t,this.$$bufferSize=i,this.$$fakeNoise=!1,this.$$init()},o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.CHANNEL_INDEX_OUT_OF_RANGE_EXCEPTION="Channel index out of range: ",o.prototype.destroy=function(){var e,t;for(e=0;e<this.$$channelTransmit.length;e++)t=this.$$channelTransmit[e],t.destroy();this.$$channelTransmit.length=0},o.prototype.getOutputNode=function(){return this.$$scriptNode},o.prototype.getChannelSize=function(){return this.$$channelTransmit.length},o.prototype.getChannel=function(e){if(e<0||e>=this.$$channelTransmit.length)throw o.CHANNEL_INDEX_OUT_OF_RANGE_EXCEPTION+e;return this.$$channelTransmit[e]},o.prototype.getBufferSize=function(){return this.$$scriptNode.bufferSize},o.prototype.$$init=function(){var e,t;for(this.$$scriptNode=i.createScriptProcessor(this.$$bufferSize,1,1),this.$$scriptNode.onaudioprocess=this.onAudioProcess.bind(this),e=0;e<this.$$configuration.length;e++)t=n.build(e,this.$$configuration[e]),this.$$channelTransmit.push(t)},o.prototype.enableFakeNoise=function(){this.$$fakeNoise=!0},o.prototype.disableFakeNoise=function(){this.$$fakeNoise=!1},o.prototype.onAudioProcess=function(e){var n,o,a,s=e.outputBuffer,$=s.getChannelData(0),l=i.getCurrentTime();for(o=0;o<s.length;o++){for(n=0,a=0;a<this.$$channelTransmit.length;a++)n+=this.$$channelTransmit[a].getSample();this.$$fakeNoise&&(n+=(2*t.random()-1)*r.FAKE_NOISE_MAX_AMPLITUDE),$[o]=n}this.$$computeCpuLoadData(l,i.getCurrentTime(),s.length)},o}AudioNetwork.Injector.registerFactory("PhysicalLayer.ChannelTransmitManager",e),e.$inject=["PhysicalLayer.AbstractChannelManager","Common.MathUtil","Audio.ActiveAudioContext","PhysicalLayer.DefaultConfig","PhysicalLayer.ChannelTransmitBuilder"]}(),function(){function e(e){function t(t,i){return new e(t,i)}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayer.ChannelTransmitBuilder",e),e.$inject=["PhysicalLayer.ChannelTransmit"]}(),function(){function e(e,t,i){var r;return r=function(e,t){this.$$carrierGenerate=[],this.$$carrierFrequency=[],this.$$carrierPhaseCorrection=[],this.$$index=e,this.configure(t)},r.DATA_LENGTH_DOES_NOT_MATCH_OFDM_SIZE_EXCEPTION="Data array length does not match configured OFDM size",r.OFDM_INDEX_OUT_OF_RANGE_EXCEPTION="OFDM index out of range: ",r.prototype.addToQueue=function(e){var t;if(e.length!==this.$$carrierGenerate.length)throw r.DATA_LENGTH_DOES_NOT_MATCH_OFDM_SIZE_EXCEPTION;for(t=0;t<this.$$carrierGenerate.length;t++)this.$$carrierGenerate[t].addToQueue(e[t])},r.prototype.getOfdmSize=function(){return this.$$carrierGenerate.length},r.prototype.$$checkOfdmIndex=function(e){if(e<0||e>=this.$$carrierGenerate.length)throw r.OFDM_INDEX_OUT_OF_RANGE_EXCEPTION+e},r.prototype.getTxPhaseCorrection=function(e){return this.$$checkOfdmIndex(e),this.$$carrierPhaseCorrection[e]},r.prototype.getFrequency=function(e){return this.$$checkOfdmIndex(e),this.$$carrierFrequency[e]},r.prototype.setTxPhaseCorrection=function(t,i){this.$$checkOfdmIndex(t),this.$$carrierPhaseCorrection[t]=i-e.floor(i),this.$$carrierGenerate[t].setPhaseCorrection(this.$$carrierPhaseCorrection[t])},r.prototype.setFrequency=function(e,i){var r;this.$$checkOfdmIndex(e),r=t.getSampleRate()/i,this.$$carrierGenerate[e].setSamplePerPeriod(r),this.$$carrierFrequency[e]=i},r.prototype.configure=function(e){var r,n,o,a;for(r=0;r<e.ofdmSize;r++)a=e.baseFrequency+r*e.ofdmFrequencySpacing,o=t.getSampleRate()/a,n=i.build(o),this.$$carrierGenerate.push(n),this.$$carrierFrequency.push(a),this.$$carrierPhaseCorrection.push(0)},r.prototype.getSample=function(){var e,t,i;for(e=0,i=0;i<this.$$carrierGenerate.length;i++)t=this.$$carrierGenerate[i],e+=t.getSample(),t.nextSample();return e},r.prototype.destroy=function(){this.$$carrierGenerate.length=0,this.$$carrierFrequency.length=0,this.$$carrierPhaseCorrection.length=0},r}AudioNetwork.Injector.registerFactory("PhysicalLayer.ChannelTransmit",e),
e.$inject=["Common.MathUtil","Audio.ActiveAudioContext","Common.CarrierGenerateBuilder"]}(),function(){function e(e){function t(){return new e}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.GuardPowerCollectorBuilder",e),e.$inject=["PhysicalLayerAdapter.GuardPowerCollector"]}(),function(){function e(e,t){var i;return i=function(){e.apply(this,arguments)},i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.EMPTY_LIST_EXCEPTION="Cannot finalize GuardPowerCollector without any samples collected",i.prototype.$$finalize=function(){if(0===this.$$valueList.length)throw i.EMPTY_LIST_EXCEPTION;return t.minInArray(this.$$valueList)},i}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.GuardPowerCollector",e),e.$inject=["Common.AbstractValueCollector","Common.MathUtil"]}(),function(){function e(e){function t(){return new e}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.PhaseOffsetCollectorBuilder",e),e.$inject=["PhysicalLayerAdapter.PhaseOffsetCollector"]}(),function(){function e(e,t){var i;return i=function(){e.apply(this,arguments)},i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.prototype.$$finalize=function(){var e,i,r,n,o="";if(0===this.$$valueList.length)return null;for(e=0;e<this.$$valueList.length;e++)o+=t.round(1e3*this.$$valueList[e].time)/1e3+" "+t.round(1e3*this.$$valueList[e].phase)/1e3+" | ";return i=t.round(.43*this.$$valueList.length),r=t.round(.57*this.$$valueList.length),r=r>=this.$$valueList.length?this.$$valueList.length-1:r,n=0,i!==r&&i<r&&(console.log("phase history indexA",this.$$valueList[i].time,this.$$valueList[i].phase),console.log("phase history indexB",this.$$valueList[r].time,this.$$valueList[r].phase),n=-(this.$$valueList[r].phase-this.$$valueList[i].phase)/(this.$$valueList[r].time-this.$$valueList[i].time),console.log("phase history drift",n)),n},i.prototype.collect=function(e){this.$$valueList.push({time:e.stateDurationTime,phase:e.carrierDetail[0].phase})},i}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.PhaseOffsetCollector",e),e.$inject=["Common.AbstractValueCollector","Common.MathUtil"]}(),function(){function e(e){function t(t,i){return new e(t,i)}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayer.RxHandlerBuilder",e),e.$inject=["PhysicalLayer.RxHandler"]}(),function(){function e(e,t,i){var r;return r=function(e,t){this.$$delayedData=[],this.$$rxConstellationDiagram=e,this.$$rxExternalHandler=t,this.$$intervalId=setInterval(this.$$intervalHandler.bind(this),r.$$_DELAY_LOOP_RESOLUTION)},r.$$_RX_EXTRA_DELAY=.05,r.$$_DELAY_LOOP_RESOLUTION=8,r.prototype.$$intervalHandler=function(){var e,i,n=t.getCurrentTime(),o=0;for(i=0;i<this.$$delayedData.length&&(e=this.$$delayedData[i],e.time<n-r.$$_RX_EXTRA_DELAY);i++)this.$$handle(e.channelIndex,e.carrierDetail,e.time),o++;o>0&&this.$$delayedData.splice(0,o)},r.prototype.handle=function(e,t,i){this.$$delayedData.push({channelIndex:e,carrierDetail:t,time:i})},r.prototype.$$handle=function(i,r,n){var o,a,s;for(o=0;o<r.length;o++)a=r[o],a.powerDecibel===-(1/0)&&(a.powerDecibel=e.MINIMUM_POWER_DECIBEL),a.powerDecibel=a.powerDecibel<e.MINIMUM_POWER_DECIBEL?e.MINIMUM_POWER_DECIBEL:a.powerDecibel,0!==this.$$rxConstellationDiagram.length&&(s=this.$$rxConstellationDiagram[i].queue[o],s.pushEvenIfFull({powerDecibel:a.powerDecibel,phase:a.phase}));this.$$rxExternalHandler.callback&&this.$$rxExternalHandler.callback(i,r,t.getCurrentTime())},r.prototype.destroy=function(){clearInterval(this.$$intervalId)},r}AudioNetwork.Injector.registerFactory("PhysicalLayer.RxHandler",e),e.$inject=["PhysicalLayer.DefaultConfig","Audio.ActiveAudioContext","Common.MathUtil"]}(),function(){function e(e){function t(t,i,r,n,o,a,s,$,l){return new e(t,i,r,n,o,a,s,$,l)}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.RxStateMachineBuilder",e),e.$inject=["PhysicalLayerAdapter.RxStateMachine"]}(),function(){function e(e){var t;return t=function(t,i,r,n,o,a,s,$,l){this.$$stateHandler={},this.$$stateHandler[e.IDLE_INIT]=t,this.$$stateHandler[e.FIRST_SYNC_WAIT]=i,this.$$stateHandler[e.FIRST_SYNC]=r,this.$$stateHandler[e.FATAL_ERROR]=n,this.$$stateHandler[e.IDLE]=o,this.$$stateHandler[e.SYMBOL]=a,this.$$stateHandler[e.SYNC]=s,this.$$stateHandler[e.GUARD]=$,this.$$stateHandler[e.ERROR]=l,this.$$symbolStateMaxDurationTime=null,this.$$guardStateMaxDurationTime=null,this.$$syncStateMaxDurationTime=null,this.$$state=null,this.$$stateDurationTime=null,this.$$stateBeginTime=null,this.$$resetFlag=!0},t.SET_ALL_MAX_DURATION_TIMES_FIRST_EXCEPTION="Please set all max duration times first",t.prototype.scheduleReset=function(){this.$$resetFlag=!0},t.prototype.$$changeState=function(e,t){null!==e?(this.$$state=e,this.$$stateBeginTime=t):this.$$stateDurationTime=t-this.$$stateBeginTime},t.prototype.$$handlerIdleInit=function(t,i){var r;return this.$$changeState(null,i),r=this.$$stateHandler[e.IDLE_INIT](this.$$stateDurationTime),!r||(this.$$changeState(r,i),!1)},t.prototype.$$handlerFirstSyncWait=function(t,i){return t?(this.$$changeState(e.FIRST_SYNC,i),!1):(this.$$changeState(null,i),this.$$stateHandler[e.FIRST_SYNC_WAIT](this.$$stateDurationTime),!0)},t.prototype.$$handlerFirstSync=function(t,i){var r;return this.$$changeState(null,i),r=this.$$stateHandler[e.FIRST_SYNC](this.$$stateDurationTime),!r||(this.$$changeState(r,i),!1)},t.prototype.$$handlerFatalError=function(t,i){var r;return this.$$changeState(null,i),r=this.$$stateHandler[e.FATAL_ERROR](this.$$stateDurationTime),!r||(this.$$changeState(r,i),!1)},t.prototype.$$handlerIdle=function(t,i){return t?(this.$$changeState(e.SYMBOL,i),!1):(this.$$changeState(null,i),this.$$stateHandler[e.IDLE](this.$$stateDurationTime),!0)},t.prototype.$$handlerSymbol=function(t,i){return t?(this.$$changeState(null,i),this.$$stateHandler[e.SYMBOL](this.$$stateDurationTime),!(this.$$stateDurationTime>this.$$symbolStateMaxDurationTime)||(this.$$changeState(e.SYNC,i),!1)):(this.$$changeState(e.GUARD,i),!1)},t.prototype.$$handlerSync=function(t,i){return t?(this.$$changeState(null,i),this.$$stateHandler[e.SYNC](this.$$stateDurationTime),!(this.$$stateDurationTime>this.$$syncStateMaxDurationTime)||(this.$$changeState(e.ERROR,i),!1)):(this.$$changeState(e.IDLE,i),!1)},t.prototype.$$handlerGuard=function(t,i){return t?(this.$$changeState(e.SYMBOL,i),!1):(this.$$changeState(null,i),this.$$stateHandler[e.GUARD](this.$$stateDurationTime),!(this.$$stateDurationTime>this.$$guardStateMaxDurationTime)||(this.$$changeState(e.IDLE,i),!1))},t.prototype.$$handlerError=function(t,i){return t?(this.$$changeState(null,i),this.$$stateHandler[e.ERROR](this.$$stateDurationTime),!0):(this.$$changeState(e.IDLE,i),!1)},t.prototype.setGuardStateMaxDurationTime=function(e){this.$$guardStateMaxDurationTime=e},t.prototype.setSymbolStateMaxDurationTime=function(e){this.$$symbolStateMaxDurationTime=e},t.prototype.setSyncStateMaxDurationTime=function(e){this.$$syncStateMaxDurationTime=e},t.prototype.getState=function(i,r){var n,o=e;if(this.$$resetFlag&&(this.$$changeState(o.IDLE_INIT,r),this.$$resetFlag=!1),null===this.$$guardStateMaxDurationTime||null===this.$$symbolStateMaxDurationTime||null===this.$$syncStateMaxDurationTime)throw t.SET_ALL_MAX_DURATION_TIMES_FIRST_EXCEPTION;for(;;){switch(this.$$state){case o.IDLE_INIT:n=this.$$handlerIdleInit(i,r);break;case o.FIRST_SYNC_WAIT:n=this.$$handlerFirstSyncWait(i,r);break;case o.FIRST_SYNC:n=this.$$handlerFirstSync(i,r);break;case o.FATAL_ERROR:n=this.$$handlerFatalError(i,r);break;case o.IDLE:n=this.$$handlerIdle(i,r);break;case o.SYMBOL:n=this.$$handlerSymbol(i,r);break;case o.SYNC:n=this.$$handlerSync(i,r);break;case o.GUARD:n=this.$$handlerGuard(i,r);break;case o.ERROR:n=this.$$handlerError(i,r)}if(n)break}return this.$$state},t}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.RxStateMachine",e),e.$inject=["PhysicalLayerAdapter.ReceiveAdapterState"]}(),function(){function e(e){function t(){return new e}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.SignalPowerCollectorBuilder",e),e.$inject=["PhysicalLayerAdapter.SignalPowerCollector"]}(),function(){function e(e,t){var i;return i=function(){e.apply(this,arguments)},i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.EMPTY_LIST_EXCEPTION="Cannot finalize SignalPowerCollector without any samples collected",i.prototype.$$finalize=function(){if(0===this.$$valueList.length)throw i.EMPTY_LIST_EXCEPTION;return t.maxInArray(this.$$valueList)},i}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.SignalPowerCollector",e),e.$inject=["Common.AbstractValueCollector","Common.MathUtil"]}(),function(){function e(e){function t(t,i,r,n){return new e(t,i,r,n)}return{build:t}}AudioNetwork.Injector.registerService("PhysicalLayerAdapter.RxStateMachineManagerBuilder",e),e.$inject=["PhysicalLayerAdapter.RxStateMachineManager"]}(),function(){function e(e,t,i,r,n,o,a,s,$){var l;return l=function(e,t,r,$){this.$$channelIndex=e,this.$$packetReceiveHandler=t,this.$$frequencyUpdateHandler=r,this.$$phaseCorrectionUpdateHandler=$,this.$$stateMachine=s.build(this.$$handlerIdleInit.bind(this),this.$$handlerFirstSyncWait.bind(this),this.$$handlerFirstSync.bind(this),this.$$handlerFatalError.bind(this),this.$$handlerIdle.bind(this),this.$$handlerSymbol.bind(this),this.$$handlerSync.bind(this),this.$$handlerGuard.bind(this),this.$$handlerError.bind(this)),this.$$sampleCollectionTimeIdleInitState=null,this.$$sampleCollectionTimeFirstSyncState=null,this.$$syncPreamble=null,this.$$pskSize=null,this.$$averageIdlePowerCollector=i.build(),this.$$averageFirstSyncPowerCollector=i.build(),this.$$signalPowerCollector=n.build(),this.$$guardPowerCollector=o.build(),this.$$phaseOffsetCollector=a.build(),this.$$resetInternal()},l.$$_INITIAL_POWER_THRESHOLD=0,l.$$_DECIBLES_ABOVE_AVERAGE_IDLE=10,l.$$_OFDM_PILOT_SIGNAL_INDEX=0,l.$$_AVERAGE_POWER_UNIT_FACTOR=.5,l.prototype.$$resetInternal=function(){this.$$averageIdlePowerCollector.clearAll(),this.$$averageFirstSyncPowerCollector.clearAll(),this.$$signalPowerCollector.clearAll(),this.$$guardPowerCollector.clearAll(),this.$$phaseOffsetCollector.clearAll(),this.$$powerThreshold=l.$$_INITIAL_POWER_THRESHOLD,this.$$currentData=null,this.$$dataPacket=[],this.$$dataSymbol=[]},l.prototype.reset=function(){this.$$resetInternal(),this.$$stateMachine.scheduleReset()},l.prototype.setSymbolStateMaxDurationTime=function(e){this.$$stateMachine.setSymbolStateMaxDurationTime(e)},l.prototype.setGuardStateMaxDurationTime=function(e){this.$$stateMachine.setGuardStateMaxDurationTime(e)},l.prototype.setSyncStateMaxDurationTime=function(e){this.$$stateMachine.setSyncStateMaxDurationTime(e)},l.prototype.setSampleCollectionTimeIdleInitState=function(e){this.$$sampleCollectionTimeIdleInitState=e},l.prototype.setSampleCollectionTimeFirstSyncState=function(e){this.$$sampleCollectionTimeFirstSyncState=e},l.prototype.setSyncPreamble=function(e){this.$$syncPreamble=e},l.prototype.setPskSize=function(e){this.$$pskSize=e},l.prototype.$$handlerIdleInit=function(e){var t=this.$$currentData.pilotSignal.powerDecibel,i=null;if(e<this.$$sampleCollectionTimeIdleInitState)this.$$averageIdlePowerCollector.collect(t);else try{this.$$powerThreshold=this.$$averageIdlePowerCollector.finalize()+l.$$_DECIBLES_ABOVE_AVERAGE_IDLE,i=$.FIRST_SYNC_WAIT}catch(r){i=$.FATAL_ERROR}return i},l.prototype.$$handlerFirstSyncWait=function(e){return null},l.prototype.$$handlerFirstSync=function(e){var t,i,r,n=this.$$currentData.pilotSignal.powerDecibel;if(this.$$averageFirstSyncPowerCollector.getLastFinalizedResult())return n<this.$$powerThreshold?$.IDLE:null;if(n<=this.$$averageIdlePowerCollector.getLastFinalizedResult())return $.FATAL_ERROR;if(e<this.$$sampleCollectionTimeFirstSyncState)this.$$phaseOffsetCollector.collect({stateDurationTime:e,carrierDetail:this.$$currentData.carrierDetail}),this.$$averageFirstSyncPowerCollector.collect(n);else try{t=this.$$averageFirstSyncPowerCollector.finalize(),i=this.$$averageIdlePowerCollector.getLastFinalizedResult(),r=t-i,this.$$powerThreshold=i+l.$$_AVERAGE_POWER_UNIT_FACTOR*r}catch(o){return $.FATAL_ERROR}},l.prototype.$$handlerFatalError=function(e){},l.prototype.$$handlerIdle=function(e){this.$$dataPacket.length>0&&(this.$$packetReceiveHandler(this.$$channelIndex,this.$$preparePacket(this.$$dataPacket)),this.$$dataPacket.length=0),this.$$phaseOffsetCollector.hasAtLeastItem()&&this.$$frequencyUpdateHandler(this.$$channelIndex,this.$$phaseOffsetCollector.finalize()),this.$$guardPowerCollector.clearList()},l.prototype.$$handlerSymbol=function(e){var t=this.$$currentData.pilotSignal.powerDecibel;this.$$signalPowerCollector.collect(t),this.$$guardPowerCollector.hasAtLeastItem()&&this.$$guardPowerCollector.finalize(),this.$$dataSymbol.push(this.$$currentData)},l.prototype.$$handlerSync=function(e){this.$$phaseOffsetCollector.collect({stateDurationTime:e,carrierDetail:this.$$currentData.carrierDetail})},l.prototype.$$handlerGuard=function(e){var i,r=this.$$currentData.pilotSignal.powerDecibel;this.$$guardPowerCollector.collect(r),this.$$signalPowerCollector.hasAtLeastItem()&&this.$$signalPowerCollector.finalize(),this.$$dataSymbol.length>0&&(i=t.findMaxValueIndex(this.$$dataSymbol,"pilotSignal.powerDecibel"),this.$$dataPacket.push(this.$$dataSymbol[i].carrierDetail),this.$$isCurrentSymbolSyncPreamble()&&this.$$phaseCorrectionUpdateHandler(this.$$channelIndex,this.$$dataSymbol[i].carrierDetail),this.$$dataSymbol=[])},l.prototype.$$handlerError=function(e){},l.prototype.$$preparePacket=function(t){var i,r,n,o,a;for(n=[],i=0;i<t.length;i++)if(0!==i||!this.$$syncPreamble){for(a=t[i],o=[],r=0;r<a.length;r++)o.push(e.round(a[r].phase*this.$$pskSize)%this.$$pskSize);n.push(o)}return n},l.prototype.$$isCurrentSymbolSyncPreamble=function(){return this.$$syncPreamble&&1===this.$$dataPacket.length},l.prototype.$$isInputReallyConnected=function(){return this.$$currentData.pilotSignal.powerDecibel!==r.MINIMUM_POWER_DECIBEL},l.prototype.$$isPilotSignalPresent=function(){return this.$$currentData.pilotSignal.powerDecibel>this.$$powerThreshold},l.prototype.receive=function(t,i){var r;return this.$$currentData={pilotSignal:t[l.$$_OFDM_PILOT_SIGNAL_INDEX],carrierDetail:t},this.$$isInputReallyConnected()?r=this.$$stateMachine.getState(this.$$isPilotSignalPresent(),i):(r=$.NO_INPUT,this.reset()),{state:r,power:"<br/>averageIdlePower: "+e.round(100*this.$$averageIdlePowerCollector.getLastFinalizedResult())/100+"<br/>averageFirstSyncPower: "+e.round(100*this.$$averageFirstSyncPowerCollector.getLastFinalizedResult())/100+" <br/>&nbsp;&nbsp;&nbsp;delta: "+e.round(100*(this.$$averageFirstSyncPowerCollector.getLastFinalizedResult()-this.$$averageIdlePowerCollector.getLastFinalizedResult()))/100+" <br/>&nbsp;&nbsp;&nbsp;powerThreshold: "+e.round(100*this.$$powerThreshold)/100+" <br/>minGuardPower: "+e.round(100*this.$$guardPowerCollector.getLastFinalizedResult())/100+" sampleSize: "+this.$$guardPowerCollector.getLastFinalizedSize()+"<br/>maxSignalPower: "+e.round(100*this.$$signalPowerCollector.getLastFinalizedResult())/100+" sampleSize: "+this.$$signalPowerCollector.getLastFinalizedSize()+"<br/>&nbsp;&nbsp;&nbsp;delta: "+e.round(100*(this.$$signalPowerCollector.getLastFinalizedResult()-this.$$guardPowerCollector.getLastFinalizedResult()))/100+" <br/>&nbsp;&nbsp;&nbsp;idealPowerThreshold: "+e.round(.5*(this.$$signalPowerCollector.getLastFinalizedResult()+this.$$guardPowerCollector.getLastFinalizedResult())*100)/100+" <br/>"}},l}AudioNetwork.Injector.registerFactory("PhysicalLayerAdapter.RxStateMachineManager",e),e.$inject=["Common.MathUtil","Common.Util","Common.AverageValueCollectorBuilder","PhysicalLayer.DefaultConfig","PhysicalLayerAdapter.SignalPowerCollectorBuilder","PhysicalLayerAdapter.GuardPowerCollectorBuilder","PhysicalLayerAdapter.PhaseOffsetCollectorBuilder","PhysicalLayerAdapter.RxStateMachineBuilder","PhysicalLayerAdapter.ReceiveAdapterState"]}(),function(){function e(){function e(e){return Math.abs(e)}function t(e){return Math.asin(e)}function i(e){return Math.sqrt(e)}function r(e){return Math.round(e)}function n(){return Math.random()}function o(e){return Math.floor(e)}function a(e){return Math.sin(e)}function s(e){return Math.cos(e)}function $(e){return Math.log(e)}function l(e){return Math.min.apply(null,e)}function c(e){return Math.max.apply(null,e)}return{LN10:Math.LN10,HALF_PI:.5*Math.PI,TWO_PI:2*Math.PI,PI:Math.PI,abs:e,floor:o,asin:t,sqrt:i,round:r,random:n,sin:a,cos:s,log:$,minInArray:l,maxInArray:c}}AudioNetwork.Injector.registerService("Common.MathUtil",e),e.$inject=[]}(),function(){function e(e){function t(){return new e}function i(e){var i,r,n,o;for(r=t(),n=0,o=0,i=0;i<e.length;i++)e[i].then(function(){n++})["catch"](function(){o++})["finally"](function(){n+o===e.length&&(0===o?r.resolve():r.reject())});return r}return{build:t,buildFromList:i}}AudioNetwork.Injector.registerService("Common.SimplePromiseBuilder",e),e.$inject=["Common.SimplePromise"]}(),function(){function e(){var e;return e=function(){this.$$state=null,this.$$value=void 0,this.$$then=null,this.$$catch=null,this.$$finally=null},e.$$STATE_RESOLVE=0,e.$$STATE_REJECT=1,e.prototype.$$callbackInvoke=function(){switch(this.$$state){case e.$$STATE_RESOLVE:this.$$then&&(this.$$then(this.$$value),this.$$then=null),this.$$finally&&(this.$$finally(this.$$value),this.$$finally=null);break;case e.$$STATE_REJECT:this.$$catch&&(this.$$catch(this.$$value),this.$$catch=null),this.$$finally&&(this.$$finally(this.$$value),this.$$finally=null)}},e.prototype.resolve=function(t){null===this.$$state&&(this.$$state=e.$$STATE_RESOLVE,this.$$value=t,this.$$callbackInvoke())},e.prototype.reject=function(t){null===this.$$state&&(this.$$state=e.$$STATE_REJECT,this.$$value=t,this.$$callbackInvoke())},e.prototype.then=function(e){return"function"==typeof e&&(this.$$then=e),this.$$callbackInvoke(),this},e.prototype["catch"]=function(e){return"function"==typeof e&&(this.$$catch=e),this.$$callbackInvoke(),this},e.prototype["finally"]=function(e){return"function"==typeof e&&(this.$$finally=e),this.$$callbackInvoke(),this},e}AudioNetwork.Injector.registerFactory("Common.SimplePromise",e),e.$inject=[]}(),function(){function e(e){function t(){return new e}return{build:t}}AudioNetwork.Injector.registerService("Common.StopwatchBuilder",e),e.$inject=["Common.Stopwatch"]}(),function(){function e(){var e;return e=function(){this.$$running=!1,this.$$timeStart=void 0,this.$$timeEnd=void 0},e.STOPWATCH_ALREADY_STARTED_EXCEPTION="Stopwatch already started",e.STOPWATCH_ALREADY_STOPPED_EXCEPTION="Stopwatch already stopped",e.RESET_BEFORE_CALLING_START_EXCEPTION="Reset stopwatch before calling start() again",e.STOPWATCH_WAS_NOT_STARTED_EXCEPTION="stopwatch was not started",e.$$_MILLISECOND_IN_SECOND=1e3,e.prototype.reset=function(){return this.$$running=!1,this.$$timeStart=void 0,this.$$timeEnd=void 0,this},e.prototype.start=function(){if(this.$$running)throw e.STOPWATCH_ALREADY_STARTED_EXCEPTION;if(this.$$timeStart&&this.$$timeEnd)throw e.RESET_BEFORE_CALLING_START_EXCEPTION;return this.$$timeStart=new Date,this.$$running=!0,this},e.prototype.stop=function(){if(!this.$$timeStart)throw e.STOPWATCH_WAS_NOT_STARTED_EXCEPTION;if(!this.$$running)throw e.STOPWATCH_ALREADY_STOPPED_EXCEPTION;return this.$$timeEnd=new Date,this.$$running=!1,this},e.prototype.getDuration=function(t){var i,r=new Date;if(!this.$$timeStart)throw e.STOPWATCH_WAS_NOT_STARTED_EXCEPTION;return i=this.$$running?r.getTime()-this.$$timeStart.getTime():this.$$timeEnd.getTime()-this.$$timeStart.getTime(),t?i/e.$$_MILLISECOND_IN_SECOND:i},e}AudioNetwork.Injector.registerFactory("Common.Stopwatch",e),e.$inject=[]}(),function(){function e(e){function t(t,i){return.3635819-.4891775*e.cos(2*e.PI*t/(i-1))+.1365995*e.cos(4*e.PI*t/(i-1))-.0106411*e.cos(6*e.PI*t/(i-1))}return{blackmanNuttall:t}}AudioNetwork.Injector.registerService("Common.WindowFunction",e),e.$inject=["Common.MathUtil"]}(),function(){function e(){function e(){var e,t,i,r=[];for(e=0;e<AudioNetwork.devScriptList.length;e++)t=AudioNetwork.bootConfig.devScriptBaseUrl+AudioNetwork.devScriptList[e],i=e===AudioNetwork.devScriptList.length-1,r.push("    '"+t+"'"+(i?"":",")+"\n");return r}function t(){var e,t=[];return e=AudioNetwork.bootConfig.prodScriptBaseUrl+AudioNetwork.bootConfig.prodScriptName,t.push("    '"+e+"'\n"),t}function i(){var i,r="";switch(AudioNetwork.bootConfig.multicoreState){case AudioNetwork.MULTICORE_STATE.ENABLED_USE_DEV_SCRIPT:i=e();break;case AudioNetwork.MULTICORE_STATE.ENABLED_USE_PROD_SCRIPT:i=t()}return r+="self.importScripts(                                                                         \n",r+=i.join(""),r+=");                                                                                          \n",r+="                                                                                            \n",r+="var                                                                                         \n",r+="    iAlias = AudioNetwork.Injector,                                                         \n",r+='    ReceiveWorker = iAlias.resolve("PhysicalLayerCore.ReceiveWorker"),                      \n',r+='    ReceiveMulticoreWorker = iAlias.resolve("PhysicalLayerCore.ReceiveMulticoreWorker"),    \n',r+="    receiveWorker = undefined;                                                              \n",r+="                                                                                            \n",r+="// eval(\"console.log('eval inside thread test');\")                                        \n",r+="                                                                                            \n",r+="self.onmessage = function(event) {                                                          \n",r+="    var                                                                                     \n",r+="        data = event.data,                                                                  \n",r+="        messageIndex = data.length > 0 ? data[0] : null,                                    \n",r+="        param = data.length > 0 ? data[1] : null,                                           \n",r+="        promise;                                                                            \n",r+="                                                                                            \n",r+="    switch (messageIndex) {                                                                 \n",r+="        case ReceiveMulticoreWorker.INITIALIZATION:                                         \n",r+="            receiveWorker = new ReceiveWorker(param);                                       \n",r+="            self.postMessage([                                                              \n",r+="                ReceiveMulticoreWorker.INITIALIZATION_SUCCESS                               \n",r+="            ]);                                                                             \n",r+="            break;                                                                          \n",r+="        case ReceiveMulticoreWorker.HANDLE_SAMPLE_BLOCK:                                    \n",r+="            promise = receiveWorker.handleSampleBlock(param);                               \n",r+="            break;                                                                          \n",r+="        case ReceiveMulticoreWorker.COMPUTE_CRAZY_SINE_SUM:                                 \n",r+="            promise = receiveWorker.computeCrazySineSum(param);                             \n",r+="            break;                                                                          \n",r+="    }                                                                                       \n",r+="                                                                                            \n",r+="    if (!promise) {                                                                         \n",r+="        return;                                                                             \n",r+="    }                                                                                       \n",r+="                                                                                            \n",r+="    promise                                                                                 \n",r+="        .then(function (result) {                                                           \n",r+="            self.postMessage([                                                              \n",r+="                messageIndex + ReceiveMulticoreWorker.MESSAGE_INDEX_OFFSET_SUCCESS,         \n",r+="                result                                                                      \n",r+="            ]);                                                                             \n",r+="        })                                                                                  \n",r+="        .catch(function () {                                                                \n",r+="            self.postMessage([                                                              \n",r+="                messageIndex + ReceiveMulticoreWorker.MESSAGE_INDEX_OFFSET_FAIL,            \n",r+="                result                                                                      \n",r+="            ]);                                                                             \n",r+="        });                                                                                 \n",r+="}                                                                                           \n",r+="                                                                                            \n"}return{getJavaScriptCode:i}}AudioNetwork.Injector.registerService("PhysicalLayerCore.ReceiveMulticoreWorkerThread",e),e.$inject=[]}(),function(){function e(e,t){var i;return i=function(t){var r,n,o;if(AudioNetwork.bootConfig.multicoreState===AudioNetwork.MULTICORE_STATE.DISABLED)throw i.MULTICORE_SUPPORT_IS_NOT_ENABLED_EXCEPTION;r=e.getJavaScriptCode(),n=new Blob([r],{type:"application/javascript"}),o=URL.createObjectURL(n),this.$$key=t,this.$$worker=new Worker(o),this.$$worker.onmessage=this.$$onMessage.bind(this),this.$$promise=[],this.$$promise.length=i.MESSAGE_TOTAL,this.$$sendToThread(i.INITIALIZATION,this.$$key)},i.MULTICORE_SUPPORT_IS_NOT_ENABLED_EXCEPTION="Multicore support is not enabled",i.PREVIOUS_PROMISE_NOT_RESOLVED_YET_EXCEPTION="Previous promise not resolved yet",i.INITIALIZATION=0,i.INITIALIZATION_SUCCESS=1,i.INITIALIZATION_FAIL=2,i.HANDLE_SAMPLE_BLOCK=3,i.HANDLE_SAMPLE_BLOCK_SUCCESS=4,i.HANDLE_SAMPLE_BLOCK_FAIL=5,i.COMPUTE_CRAZY_SINE_SUM=6,i.COMPUTE_CRAZY_SINE_SUM_SUCCESS=7,i.COMPUTE_CRAZY_SINE_SUM_FAIL=8,i.MESSAGE_TOTAL=9,i.MESSAGE_INDEX_SPACING=3,i.MESSAGE_INDEX_OFFSET_SUCCESS=1,i.MESSAGE_INDEX_OFFSET_FAIL=2,i.prototype.destroy=function(){this.$$worker&&(this.$$worker.terminate(),this.$$worker=void 0)},i.prototype.getInitialization=function(){return this.$$promise[i.INITIALIZATION]},i.prototype.$$onMessage=function(e){var t,r,n=e.data,o=n.length>0?n[0]:null,a=n.length>1?n[1]:null;for(r=0;r<this.$$promise.length;r++)if(t=this.$$promise[r]){switch(o%i.MESSAGE_INDEX_SPACING){case i.MESSAGE_INDEX_OFFSET_SUCCESS:t.resolve(a);break;case i.MESSAGE_INDEX_OFFSET_FAIL:t.reject(a)}this.$$promise[r]=void 0;break}},i.prototype.$$sendToThread=function(e,i){if(this.$$promise[e])throw ReceiveWorker.PREVIOUS_PROMISE_NOT_RESOLVED_YET_EXCEPTION;return this.$$promise[e]=t.build(),this.$$worker.postMessage([e,i]),this.$$promise[e]},i.prototype.computeCrazySineSum=function(e){return this.$$sendToThread(i.COMPUTE_CRAZY_SINE_SUM,e)},i.prototype.handleSampleBlock=function(e){return this.$$sendToThread(i.HANDLE_SAMPLE_BLOCK,e)},i}AudioNetwork.Injector.registerFactory("PhysicalLayerCore.ReceiveMulticoreWorker",e),e.$inject=["PhysicalLayerCore.ReceiveMulticoreWorkerThread","Common.SimplePromiseBuilder"]}(),function(){function e(e,t,i){var r;return r=function(t){this.$$key=t,this.$$carrierRecovery=e.build(16,16384)},r.prototype.computeCrazySineSum=function(e){for(var r=i.build(),n=0,o=0;o<9000111;o++)n+=t.sin(o);return n=e+t.abs(n),r.resolve({key:this.$$key,result:n}),r},r.prototype.handleSampleBlock=function(e){var t,r,n=i.build();for(r=0;r<16384;r++)this.$$carrierRecovery.handleSample(Math.sin(2*Math.PI*(r/16-.25)));return t=this.$$carrierRecovery.getCarrierDetail(),n.resolve({key:this.$$key,result:t}),n},r}AudioNetwork.Injector.registerFactory("PhysicalLayerCore.ReceiveWorker",e),e.$inject=["Common.CarrierRecoveryBuilder","Common.MathUtil","Common.SimplePromiseBuilder"]}(),AudioNetwork.bootConfig.createAlias&&(AudioNetwork.Rewrite={},AudioNetwork.Rewrite.Dsp={},AudioNetwork.Rewrite.PhysicalLayer={},AudioNetwork.Rewrite.Util={},AudioNetwork.Rewrite.WebAudio={},AudioNetwork.Visualizer={},AudioNetwork.Rewrite.Dsp.Complex=AudioNetwork.Injector.resolve("Rewrite.Dsp.Complex"),AudioNetwork.Rewrite.Dsp.Correlator=AudioNetwork.Injector.resolve("Rewrite.Dsp.Correlator"),AudioNetwork.Rewrite.Dsp.FFTResult=AudioNetwork.Injector.resolve("Rewrite.Dsp.FFTResult"),AudioNetwork.Rewrite.Dsp.WaveAnalyser=AudioNetwork.Injector.resolve("Rewrite.Dsp.WaveAnalyser"),AudioNetwork.Rewrite.Dsp.WaveGenerator=AudioNetwork.Injector.resolve("Rewrite.Dsp.WaveGenerator"),AudioNetwork.Rewrite.PhysicalLayer.PhysicalLayerBuilder=AudioNetwork.Injector.resolve("Rewrite.PhysicalLayer.PhysicalLayerBuilder"),AudioNetwork.Rewrite.Util.Buffer=AudioNetwork.Injector.resolve("Rewrite.Util.Buffer"),AudioNetwork.Rewrite.Util.FrequencyCalculator=AudioNetwork.Injector.resolve("Rewrite.Util.FrequencyCalculator"),AudioNetwork.Rewrite.Util.MusicCalculator=AudioNetwork.Injector.resolve("Rewrite.Util.MusicCalculator"),AudioNetwork.Rewrite.Util.SmartTimer=AudioNetwork.Injector.resolve("Rewrite.Util.SmartTimer"),AudioNetwork.Rewrite.Util.WavAudioFile=AudioNetwork.Injector.resolve("Rewrite.Util.WavAudioFile"),AudioNetwork.Rewrite.WebAudio.AudioMonoIO=AudioNetwork.Injector.resolve("Rewrite.WebAudio.AudioMonoIO"),AudioNetwork.Rewrite.WebAudio.AudioMonoIOLite=AudioNetwork.Injector.resolve("Rewrite.WebAudio.AudioMonoIOLite"),AudioNetwork.Visualizer.AnalyserChart=AudioNetwork.Injector.resolve("Visualizer.AnalyserChart"),AudioNetwork.Visualizer.ConstellationDiagram=AudioNetwork.Injector.resolve("Visualizer.ConstellationDiagram"),AudioNetwork.Visualizer.PowerChart=AudioNetwork.Injector.resolve("Visualizer.PowerChart"),AudioNetwork.Visualizer.SampleChart=AudioNetwork.Injector.resolve("Visualizer.SampleChart"),AudioNetwork.Visualizer.FrequencyDomainChart=AudioNetwork.Injector.resolve("Visualizer.FrequencyDomainChart"),AudioNetwork.Visualizer.ComplexPlaneChart=AudioNetwork.Injector.resolve("Visualizer.ComplexPlaneChart"),AudioNetwork.PhysicalLayer={},AudioNetwork.PhysicalLayerAdapter={},AudioNetwork.Audio={},AudioNetwork.Common={},AudioNetwork.PhysicalLayer.PhysicalLayer=AudioNetwork.Injector.resolve("PhysicalLayer.PhysicalLayer"),AudioNetwork.PhysicalLayer.DefaultConfig=AudioNetwork.Injector.resolve("PhysicalLayer.DefaultConfig"),AudioNetwork.PhysicalLayer.RxInput=AudioNetwork.Injector.resolve("PhysicalLayer.RxInput"),AudioNetwork.PhysicalLayerAdapter.TransmitAdapter=AudioNetwork.Injector.resolve("PhysicalLayerAdapter.TransmitAdapter"),AudioNetwork.PhysicalLayerAdapter.ReceiveAdapter=AudioNetwork.Injector.resolve("PhysicalLayerAdapter.ReceiveAdapter"),AudioNetwork.Audio.ActiveAudioContext=AudioNetwork.Injector.resolve("Audio.ActiveAudioContext"),AudioNetwork.Audio.SimpleAudioContext=AudioNetwork.Injector.resolve("Audio.SimpleAudioContext"),AudioNetwork.Common.Queue=AudioNetwork.Injector.resolve("Common.Queue"),AudioNetwork.Common.CarrierRecovery=AudioNetwork.Injector.resolve("Common.CarrierRecovery"),AudioNetwork.Common.CarrierGenerate=AudioNetwork.Injector.resolve("Common.CarrierGenerate"),AudioNetwork.Common.WindowFunction=AudioNetwork.Injector.resolve("Common.WindowFunction"),
AudioNetwork.Common.Util=AudioNetwork.Injector.resolve("Common.Util")),AudioNetwork.isNode&&(module.exports=AudioNetwork);